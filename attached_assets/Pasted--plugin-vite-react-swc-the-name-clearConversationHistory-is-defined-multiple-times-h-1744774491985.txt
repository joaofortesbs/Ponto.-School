[plugin:vite:react-swc] Ã— the name `clearConversationHistory` is defined multiple times
      â•­â”€[/home/runner/workspace/src/services/aiChatService.ts:887:1]
  887 â”‚ }
  888 â”‚ 
  889 â”‚ // Limpar histÃ³rico da conversa
  890 â”‚ export function clearConversationHistory(sessionId: string): void {
      Â·                 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      Â·                             â•°â”€â”€ previous definition of `clearConversationHistory` here
  891 â”‚   if (conversationHistory[sessionId]) {
  892 â”‚     // MantÃ©m apenas a mensagem do sistema
  893 â”‚     const systemMessage = conversationHistory[sessionId][0];
  894 â”‚     conversationHistory[sessionId] = [systemMessage];
  895 â”‚ 
  896 â”‚     // Limpar do localStorage tambÃ©m
  897 â”‚     try {
  898 â”‚       localStorage.removeItem(`conversationHistory_${sessionId}`);
  899 â”‚     } catch (error) {
  900 â”‚       console.error("Erro ao limpar histÃ³rico do localStorage:", error);
  901 â”‚     }
  902 â”‚   }
  903 â”‚ }
  904 â”‚ 
  905 â”‚ // Obter histÃ³rico da conversa
  906 â”‚ export function getConversationHistory(sessionId: string): ChatMessage[] {
  907 â”‚   // Primeiro verifica se jÃ¡ estÃ¡ carregado na memÃ³ria
  908 â”‚   if (conversationHistory[sessionId]) {
  909 â”‚     return conversationHistory[sessionId];
  910 â”‚   }
  911 â”‚ 
  912 â”‚   // Caso contrÃ¡rio, tenta recuperar do localStorage
  913 â”‚   try {
  914 â”‚     const savedHistory = localStorage.getItem(`conversationHistory_${sessionId}`);
  915 â”‚     if (savedHistory) {
  916 â”‚       const parsedHistory = JSON.parse(savedHistory) as ChatMessage[];
  917 â”‚       conversationHistory[sessionId] = parsedHistory;
  918 â”‚       return parsedHistory;
  919 â”‚     }
  920 â”‚   } catch (error) {
  921 â”‚     console.error("Erro ao recuperar histÃ³rico do localStorage:", error);
  922 â”‚   }
  923 â”‚ 
  924 â”‚   return [];
  925 â”‚ }
  926 â”‚ 
  927 â”‚ // FunÃ§Ã£o para corrigir links da plataforma
  928 â”‚ function fixPlatformLinks(text: string): string {
  929 â”‚   const platformLinks = {
  930 â”‚     'Portal': 'https://pontoschool.com/portal',
  931 â”‚     'Portal de Estudos': 'https://pontoschool.com/portal',
  932 â”‚     'Agenda': 'https://pontoschool.com/agenda',
  933 â”‚     'Turmas': 'https://pontoschool.com/turmas',
  934 â”‚     'Grupos de Estudo': 'https://pontoschool.com/turmas?view=estudos',
  935 â”‚     'Biblioteca': 'https://pontoschool.com/biblioteca',
  936 â”‚     'Perfil': 'https://pontoschool.com/profile',
  937 â”‚     'PÃ¡gina de Perfil': 'https://pontoschool.com/profile',
  938 â”‚     'ConfiguraÃ§Ãµes': 'https://pontoschool.com/configuracoes',
  939 â”‚     'PÃ¡gina de ConfiguraÃ§Ãµes': 'https://pontoschool.com/configuracoes',
  940 â”‚     'Dashboard': 'https://pontoschool.com/dashboard',
  941 â”‚     'Epictus IA': 'https://pontoschool.com/epictus-ia',
  942 â”‚     'Mentor IA': 'https://pontoschool.com/mentor-ia',
  943 â”‚     'Planos de Estudo': 'https://pontoschool.com/planos-estudo',
  944 â”‚     'Conquistas': 'https://pontoschool.com/conquistas',
  945 â”‚     'Carteira': 'https://pontoschool.com/carteira',
  946 â”‚     'Mercado': 'https://pontoschool.com/mercado',
  947 â”‚     'OrganizaÃ§Ã£o': 'https://pontoschool.com/organizacao',
  948 â”‚     'Comunidades': 'https://pontoschool.com/comunidades',
  949 â”‚     'Chat IA': 'https://pontoschool.com/chat-ia',
  950 â”‚     'School IA': 'https://pontoschool.com/school-ia',
  951 â”‚     'Novidades': 'https://pontoschool.com/novidades',
  952 â”‚     'Lembretes': 'https://pontoschool.com/lembretes',
  953 â”‚     'Pedidos de Ajuda': 'https://pontoschool.com/pedidos-ajuda',
  954 â”‚     'ConexÃ£o Expert': 'https://pontoschool.com/pedidos-ajuda',
  955 â”‚     'Estudos': 'https://pontoschool.com/estudos',
  956 â”‚     'Login': 'https://pontoschool.com/login',
  957 â”‚     'Cadastro': 'https://pontoschool.com/register',
  958 â”‚     'PÃ¡gina de Ajuda': 'https://pontoschool.com/ajuda',
  959 â”‚     'Ajuda': 'https://pontoschool.com/ajuda'
  960 â”‚   };
  961 â”‚ 
  962 â”‚   let newText = text;
  963 â”‚   const alreadyReplaced = new Set<string>();
  964 â”‚   const linkRegex = /\[(.+?)\]\((.+?)\)/g;
  965 â”‚ 
  966 â”‚   // Primeiro, coletar todos os links jÃ¡ presentes no texto e verificar se estÃ£o formatados corretamente
  967 â”‚   let match;
  968 â”‚ 
  969 â”‚   // Armazenar os links que precisam ser corrigidos
  970 â”‚   const linksToFix = [];
  971 â”‚ 
  972 â”‚   while ((match = linkRegex.exec(newText)) !== null) {
  973 â”‚     const linkText = match[1];
  974 â”‚     const url = match[2];
  975 â”‚     alreadyReplaced.add(url.toLowerCase());
  976 â”‚ 
  977 â”‚     // TambÃ©m adicionar o texto do link para evitar duplicaÃ§Ã£o com diferentes textos
  978 â”‚     for (const key in platformLinks) {
  979 â”‚       if (linkText.toLowerCase() === key.toLowerCase()) {
  980 â”‚         alreadyReplaced.add(platformLinks[key].toLowerCase());
  981 â”‚       }
  982 â”‚     }
  983 â”‚   }
  984 â”‚ 
  985 â”‚   // Substituir expressÃµes mais especÃ­ficas, evitando duplicidades
  986 â”‚   for (const key in platformLinks) {
  987 â”‚     const url = platformLinks[key];
  988 â”‚     // Pular se este URL jÃ¡ foi usado
  989 â”‚     if (alreadyReplaced.has(url.toLowerCase())) continue;
  990 â”‚ 
  991 â”‚     const regex = new RegExp(`\\b(${key})\\b(?![^\\[]*\\])`, 'gi'); // Busca palavras inteiras que nÃ£o estÃ£o dentro de colchetes
  992 â”‚     if (regex.test(newText)) {
  993 â”‚       newText = newText.replace(regex, `[${key}](${url})`);
  994 â”‚       alreadyReplaced.add(url.toLowerCase());
  995 â”‚     }
  996 â”‚   }
  997 â”‚ 
  998 â”‚   // Adicionar correÃ§Ã£o para URLs que podem ter sido escritas incorretamente
  999 â”‚   newText = newText.replace(/\(https:\/\/pontoschool\.com(\s+)([^)]+)\)/g, '(https://pontoschool.com/$2)');
 1000 â”‚ 
 1001 â”‚   // Corrigir URLs que podem ter dupla barra
 1002 â”‚   newText = newText.replace(/\(https:\/\/pontoschool\.com\/\/([^)]+)\)/g, '(https://pontoschool.com/$1)');
 1003 â”‚ 
 1004 â”‚   // Garantir que os links estejam formatados corretamente com os parÃªnteses fora da URL clicÃ¡vel
 1005 â”‚   // Primeiro, encontrar todos os links no formato [texto](url)
 1006 â”‚   const markdownLinkRegex = /\[([^\]]+)\]\(([^)]+)\)/g;
 1007 â”‚   newText = newText.replace(markdownLinkRegex, (match, text, url) => {
 1008 â”‚     // Certificar-se de que apenas a URL estÃ¡ dentro dos parÃªnteses
 1009 â”‚     const cleanUrl = url.split(' ')[0]; // Pegar apenas a URL sem atributos adicionais
 1010 â”‚     return `[${text}](${cleanUrl})`;
 1011 â”‚   });
 1012 â”‚ 
 1013 â”‚   return newText;
 1014 â”‚ }
 1015 â”‚ 
 1016 â”‚ 
 1017 â”‚ // FunÃ§Ã£o para salvar o histÃ³rico da conversa no localStorage
 1018 â”‚ function saveConversationHistory(sessionId: string, history: ChatMessage[]): void {
 1019 â”‚   try {
 1020 â”‚     localStorage.setItem(`conversationHistory_${sessionId}`, JSON.stringify(history));
 1021 â”‚   } catch (error) {
 1022 â”‚     console.error("Erro ao salvar o histÃ³rico da conversa:", error);
 1023 â”‚   }
 1024 â”‚ }
 1025 â”‚ 
 1026 â”‚ // SimulaÃ§Ã£o de resposta da IA
 1027 â”‚ const getResponseForMessage = (message: string): string => {
 1028 â”‚   // AnÃ¡lise bÃ¡sica da mensagem para gerar uma resposta contextual
 1029 â”‚   const formattedMessage = message.toLowerCase();
 1030 â”‚ 
 1031 â”‚   if (formattedMessage.includes('olÃ¡') || formattedMessage.includes('oi') || formattedMessage.includes('bom dia') || formattedMessage.includes('boa tarde') || formattedMessage.includes('boa noite')) {
 1032 â”‚     return `**OlÃ¡, ${userInfo?.username || 'amigo'}!** ðŸ˜Š\n\nComo posso ajudar vocÃª hoje?`;
 1033 â”‚   } else if (formattedMessage.includes('funÃ§Ã£o') || formattedMessage.includes('o que vocÃª faz') || formattedMessage.includes('para que serve')) {
 1034 â”‚     return `**Eu sou o Assistente de Suporte da Ponto.School**, aqui para te ajudar em tudo que precisar na plataforma! ðŸš€\n\nPosso ajudar com:\n\nâ€¢ **NavegaÃ§Ã£o:** Encontrar qualquer recurso na plataforma.\nâ€¢ **Tutoriais:** Explicar o funcionamento de qualquer ferramenta.\nâ€¢ **DÃºvidas:** Responder qualquer questÃ£o sobre a plataforma ou o conteÃºdo.\n\nComo posso ajudar vocÃª agora?`;
 1035 â”‚   } else if (formattedMessage.includes('portal') || formattedMessage.includes('material') || formattedMessage.includes('acessar conteÃºdo')) {
 1036 â”‚     return `VocÃª pode acessar o **Portal** com todos os materiais em https://pontoschool.com/portal\n\nLÃ¡ vocÃª encontrarÃ¡ todos os seus cursos, materiais e recursos de estudo organizados por disciplina.\n\n_Basta clicar no link acima para ir direto para o Portal!_ ðŸ“š`;
 1037 â”‚   } else {
 1038 â”‚     return "Desculpe, nÃ£o entendi sua pergunta. Pode reformulÃ¡-la?";
 1039 â”‚   }
 1040 â”‚ };
 1041 â”‚ 
 1042 â”‚ // VariÃ¡vel para controlar se a resposta estÃ¡ pausada
 1043 â”‚ let isPaused: Record<string, boolean> = {};
 1044 â”‚ 
 1045 â”‚ // FunÃ§Ã£o para pausar a resposta da IA
 1046 â”‚ export const pauseResponse = async (sessionId: string): Promise<void> => {
 1047 â”‚   try {
 1048 â”‚     isPaused[sessionId] = true;
 1049 â”‚     isCancelled[sessionId] = false; // Garantir que nÃ£o estÃ¡ cancelada
 1050 â”‚     console.log(`Resposta da IA pausada para a sessÃ£o ${sessionId}. Estado atual:`, isPaused[sessionId]);
 1051 â”‚   } catch (error) {
 1052 â”‚     console.error('Erro ao pausar resposta da IA:', error);
 1053 â”‚     throw error;
 1054 â”‚   }
 1055 â”‚ };
 1056 â”‚ 
 1057 â”‚ // FunÃ§Ã£o para verificar se a resposta estÃ¡ pausada
 1058 â”‚ export const isResponsePaused = (sessionId: string): boolean => {
 1059 â”‚   const paused = isPaused[sessionId] || false;
 1060 â”‚   // Para debugging
 1061 â”‚   if (paused) {
 1062 â”‚     console.log(`VerificaÃ§Ã£o de pausa: sessÃ£o ${sessionId} estÃ¡ pausada`);
 1063 â”‚   }
 1064 â”‚   return paused;
 1065 â”‚ };
 1066 â”‚ 
 1067 â”‚ // VariÃ¡vel para controlar se a resposta foi cancelada
 1068 â”‚ let isCancelled: Record<string, boolean> = {};
 1069 â”‚ 
 1070 â”‚ // FunÃ§Ã£o para cancelar a resposta da IA
 1071 â”‚ export const cancelResponse = async (sessionId: string): Promise<void> => {
 1072 â”‚   try {
 1073 â”‚     isCancelled[sessionId] = true;
 1074 â”‚     isPaused[sessionId] = false; // Certifique-se de que nÃ£o estÃ¡ em pausa tambÃ©m
 1075 â”‚     console.log(`Resposta da IA cancelada para a sessÃ£o ${sessionId}. Estado atual:`, isCancelled[sessionId]);
 1076 â”‚   } catch (error) {
 1077 â”‚     console.error('Erro ao cancelar resposta da IA:', error);
 1078 â”‚     throw error;
 1079 â”‚   }
 1080 â”‚ };
 1081 â”‚ 
 1082 â”‚ // FunÃ§Ã£o para verificar se a resposta foi cancelada
 1083 â”‚ export const isResponseCancelled = (sessionId: string): boolean => {
 1084 â”‚   const cancelled = isCancelled[sessionId] || false;
 1085 â”‚   // Para debugging
 1086 â”‚   if (cancelled) {
 1087 â”‚     console.log(`VerificaÃ§Ã£o de cancelamento: sessÃ£o ${sessionId} estÃ¡ cancelada`);
 1088 â”‚   }
 1089 â”‚   return cancelled;
 1090 â”‚ };
 1091 â”‚ 
 1092 â”‚ // FunÃ§Ã£o para retomar a resposta da IA
 1093 â”‚ export const resumeResponse = async (sessionId: string): Promise<void> => {
 1094 â”‚   try {
 1095 â”‚     isPaused[sessionId] = false;
 1096 â”‚     console.log(`Resposta da IA retomada para a sessÃ£o ${sessionId}. Estado atual:`, isPaused[sessionId]);
 1097 â”‚   } catch (error) {
 1098 â”‚     console.error('Erro ao retomar resposta da IA:', error);
 1099 â”‚     throw error;
 1100 â”‚   }
 1101 â”‚ };
 1102 â”‚ 
 1103 â”‚ // FunÃ§Ã£o para resetar o estado de cancelamento/pausa (Ãºtil ao iniciar novas respostas)
 1104 â”‚ export const resetResponseState = (sessionId: string): void => {
 1105 â”‚   const wasPaused = isPaused[sessionId];
 1106 â”‚   const wasCancelled = isCancelled[sessionId];
 1107 â”‚ 
 1108 â”‚   isPaused[sessionId] = false;
 1109 â”‚   isCancelled[sessionId] = false;
 1110 â”‚ 
 1111 â”‚   console.log(`Estados resetados para a sessÃ£o ${sessionId}. 
 1112 â”‚     Estado anterior: pausado=${wasPaused}, cancelado=${wasCancelled}. 
 1113 â”‚     Estado atual: pausado=${isPaused[sessionId]}, cancelado=${isCancelled[sessionId]}`);
 1114 â”‚ };
 1115 â”‚ 
 1116 â”‚ // Limpar histÃ³rico da conversa
 1117 â”‚ export function clearConversationHistory(sessionId: string): void {
      Â·                 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      Â·                             â•°â”€â”€ `clearConversationHistory` redefined here
 1118 â”‚   if (conversationHistory[sessionId]) {
 1119 â”‚     // MantÃ©m apenas a mensagem do sistema
 1120 â”‚     const systemMessage = conversationHistory[sessionId][0];
      â•°â”€â”€â”€â”€

  Ã— the name `getConversationHistory` is defined multiple times
      â•­â”€[/home/runner/workspace/src/services/aiChatService.ts:903:1]
  903 â”‚ }
  904 â”‚ 
  905 â”‚ // Obter histÃ³rico da conversa
  906 â”‚ export function getConversationHistory(sessionId: string): ChatMessage[] {
      Â·                 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      Â·                            â•°â”€â”€ previous definition of `getConversationHistory` here
  907 â”‚   // Primeiro verifica se jÃ¡ estÃ¡ carregado na memÃ³ria
  908 â”‚   if (conversationHistory[sessionId]) {
  909 â”‚     return conversationHistory[sessionId];
  910 â”‚   }
  911 â”‚ 
  912 â”‚   // Caso contrÃ¡rio, tenta recuperar do localStorage
  913 â”‚   try {
  914 â”‚     const savedHistory = localStorage.getItem(`conversationHistory_${sessionId}`);
  915 â”‚     if (savedHistory) {
  916 â”‚       const parsedHistory = JSON.parse(savedHistory) as ChatMessage[];
  917 â”‚       conversationHistory[sessionId] = parsedHistory;
  918 â”‚       return parsedHistory;
  919 â”‚     }
  920 â”‚   } catch (error) {
  921 â”‚     console.error("Erro ao recuperar histÃ³rico do localStorage:", error);
  922 â”‚   }
  923 â”‚ 
  924 â”‚   return [];
  925 â”‚ }
  926 â”‚ 
  927 â”‚ // FunÃ§Ã£o para corrigir links da plataforma
  928 â”‚ function fixPlatformLinks(text: string): string {
  929 â”‚   const platformLinks = {
  930 â”‚     'Portal': 'https://pontoschool.com/portal',
  931 â”‚     'Portal de Estudos': 'https://pontoschool.com/portal',
  932 â”‚     'Agenda': 'https://pontoschool.com/agenda',
  933 â”‚     'Turmas': 'https://pontoschool.com/turmas',
  934 â”‚     'Grupos de Estudo': 'https://pontoschool.com/turmas?view=estudos',
  935 â”‚     'Biblioteca': 'https://pontoschool.com/biblioteca',
  936 â”‚     'Perfil': 'https://pontoschool.com/profile',
  937 â”‚     'PÃ¡gina de Perfil': 'https://pontoschool.com/profile',
  938 â”‚     'ConfiguraÃ§Ãµes': 'https://pontoschool.com/configuracoes',
  939 â”‚     'PÃ¡gina de ConfiguraÃ§Ãµes': 'https://pontoschool.com/configuracoes',
  940 â”‚     'Dashboard': 'https://pontoschool.com/dashboard',
  941 â”‚     'Epictus IA': 'https://pontoschool.com/epictus-ia',
  942 â”‚     'Mentor IA': 'https://pontoschool.com/mentor-ia',
  943 â”‚     'Planos de Estudo': 'https://pontoschool.com/planos-estudo',
  944 â”‚     'Conquistas': 'https://pontoschool.com/conquistas',
  945 â”‚     'Carteira': 'https://pontoschool.com/carteira',
  946 â”‚     'Mercado': 'https://pontoschool.com/mercado',
  947 â”‚     'OrganizaÃ§Ã£o': 'https://pontoschool.com/organizacao',
  948 â”‚     'Comunidades': 'https://pontoschool.com/comunidades',
  949 â”‚     'Chat IA': 'https://pontoschool.com/chat-ia',
  950 â”‚     'School IA': 'https://pontoschool.com/school-ia',
  951 â”‚     'Novidades': 'https://pontoschool.com/novidades',
  952 â”‚     'Lembretes': 'https://pontoschool.com/lembretes',
  953 â”‚     'Pedidos de Ajuda': 'https://pontoschool.com/pedidos-ajuda',
  954 â”‚     'ConexÃ£o Expert': 'https://pontoschool.com/pedidos-ajuda',
  955 â”‚     'Estudos': 'https://pontoschool.com/estudos',
  956 â”‚     'Login': 'https://pontoschool.com/login',
  957 â”‚     'Cadastro': 'https://pontoschool.com/register',
  958 â”‚     'PÃ¡gina de Ajuda': 'https://pontoschool.com/ajuda',
  959 â”‚     'Ajuda': 'https://pontoschool.com/ajuda'
  960 â”‚   };
  961 â”‚ 
  962 â”‚   let newText = text;
  963 â”‚   const alreadyReplaced = new Set<string>();
  964 â”‚   const linkRegex = /\[(.+?)\]\((.+?)\)/g;
  965 â”‚ 
  966 â”‚   // Primeiro, coletar todos os links jÃ¡ presentes no texto e verificar se estÃ£o formatados corretamente
  967 â”‚   let match;
  968 â”‚ 
  969 â”‚   // Armazenar os links que precisam ser corrigidos
  970 â”‚   const linksToFix = [];
  971 â”‚ 
  972 â”‚   while ((match = linkRegex.exec(newText)) !== null) {
  973 â”‚     const linkText = match[1];
  974 â”‚     const url = match[2];
  975 â”‚     alreadyReplaced.add(url.toLowerCase());
  976 â”‚ 
  977 â”‚     // TambÃ©m adicionar o texto do link para evitar duplicaÃ§Ã£o com diferentes textos
  978 â”‚     for (const key in platformLinks) {
  979 â”‚       if (linkText.toLowerCase() === key.toLowerCase()) {
  980 â”‚         alreadyReplaced.add(platformLinks[key].toLowerCase());
  981 â”‚       }
  982 â”‚     }
  983 â”‚   }
  984 â”‚ 
  985 â”‚   // Substituir expressÃµes mais especÃ­ficas, evitando duplicidades
  986 â”‚   for (const key in platformLinks) {
  987 â”‚     const url = platformLinks[key];
  988 â”‚     // Pular se este URL jÃ¡ foi usado
  989 â”‚     if (alreadyReplaced.has(url.toLowerCase())) continue;
  990 â”‚ 
  991 â”‚     const regex = new RegExp(`\\b(${key})\\b(?![^\\[]*\\])`, 'gi'); // Busca palavras inteiras que nÃ£o estÃ£o dentro de colchetes
  992 â”‚     if (regex.test(newText)) {
  993 â”‚       newText = newText.replace(regex, `[${key}](${url})`);
  994 â”‚       alreadyReplaced.add(url.toLowerCase());
  995 â”‚     }
  996 â”‚   }
  997 â”‚ 
  998 â”‚   // Adicionar correÃ§Ã£o para URLs que podem ter sido escritas incorretamente
  999 â”‚   newText = newText.replace(/\(https:\/\/pontoschool\.com(\s+)([^)]+)\)/g, '(https://pontoschool.com/$2)');
 1000 â”‚ 
 1001 â”‚   // Corrigir URLs que podem ter dupla barra
 1002 â”‚   newText = newText.replace(/\(https:\/\/pontoschool\.com\/\/([^)]+)\)/g, '(https://pontoschool.com/$1)');
 1003 â”‚ 
 1004 â”‚   // Garantir que os links estejam formatados corretamente com os parÃªnteses fora da URL clicÃ¡vel
 1005 â”‚   // Primeiro, encontrar todos os links no formato [texto](url)
 1006 â”‚   const markdownLinkRegex = /\[([^\]]+)\]\(([^)]+)\)/g;
 1007 â”‚   newText = newText.replace(markdownLinkRegex, (match, text, url) => {
 1008 â”‚     // Certificar-se de que apenas a URL estÃ¡ dentro dos parÃªnteses
 1009 â”‚     const cleanUrl = url.split(' ')[0]; // Pegar apenas a URL sem atributos adicionais
 1010 â”‚     return `[${text}](${cleanUrl})`;
 1011 â”‚   });
 1012 â”‚ 
 1013 â”‚   return newText;
 1014 â”‚ }
 1015 â”‚ 
 1016 â”‚ 
 1017 â”‚ // FunÃ§Ã£o para salvar o histÃ³rico da conversa no localStorage
 1018 â”‚ function saveConversationHistory(sessionId: string, history: ChatMessage[]): void {
 1019 â”‚   try {
 1020 â”‚     localStorage.setItem(`conversationHistory_${sessionId}`, JSON.stringify(history));
 1021 â”‚   } catch (error) {
 1022 â”‚     console.error("Erro ao salvar o histÃ³rico da conversa:", error);
 1023 â”‚   }
 1024 â”‚ }
 1025 â”‚ 
 1026 â”‚ // SimulaÃ§Ã£o de resposta da IA
 1027 â”‚ const getResponseForMessage = (message: string): string => {
 1028 â”‚   // AnÃ¡lise bÃ¡sica da mensagem para gerar uma resposta contextual
 1029 â”‚   const formattedMessage = message.toLowerCase();
 1030 â”‚ 
 1031 â”‚   if (formattedMessage.includes('olÃ¡') || formattedMessage.includes('oi') || formattedMessage.includes('bom dia') || formattedMessage.includes('boa tarde') || formattedMessage.includes('boa noite')) {
 1032 â”‚     return `**OlÃ¡, ${userInfo?.username || 'amigo'}!** ðŸ˜Š\n\nComo posso ajudar vocÃª hoje?`;
 1033 â”‚   } else if (formattedMessage.includes('funÃ§Ã£o') || formattedMessage.includes('o que vocÃª faz') || formattedMessage.includes('para que serve')) {
 1034 â”‚     return `**Eu sou o Assistente de Suporte da Ponto.School**, aqui para te ajudar em tudo que precisar na plataforma! ðŸš€\n\nPosso ajudar com:\n\nâ€¢ **NavegaÃ§Ã£o:** Encontrar qualquer recurso na plataforma.\nâ€¢ **Tutoriais:** Explicar o funcionamento de qualquer ferramenta.\nâ€¢ **DÃºvidas:** Responder qualquer questÃ£o sobre a plataforma ou o conteÃºdo.\n\nComo posso ajudar vocÃª agora?`;
 1035 â”‚   } else if (formattedMessage.includes('portal') || formattedMessage.includes('material') || formattedMessage.includes('acessar conteÃºdo')) {
 1036 â”‚     return `VocÃª pode acessar o **Portal** com todos os materiais em https://pontoschool.com/portal\n\nLÃ¡ vocÃª encontrarÃ¡ todos os seus cursos, materiais e recursos de estudo organizados por disciplina.\n\n_Basta clicar no link acima para ir direto para o Portal!_ ðŸ“š`;
 1037 â”‚   } else {
 1038 â”‚     return "Desculpe, nÃ£o entendi sua pergunta. Pode reformulÃ¡-la?";
 1039 â”‚   }
 1040 â”‚ };
 1041 â”‚ 
 1042 â”‚ // VariÃ¡vel para controlar se a resposta estÃ¡ pausada
 1043 â”‚ let isPaused: Record<string, boolean> = {};
 1044 â”‚ 
 1045 â”‚ // FunÃ§Ã£o para pausar a resposta da IA
 1046 â”‚ export const pauseResponse = async (sessionId: string): Promise<void> => {
 1047 â”‚   try {
 1048 â”‚     isPaused[sessionId] = true;
 1049 â”‚     isCancelled[sessionId] = false; // Garantir que nÃ£o estÃ¡ cancelada
 1050 â”‚     console.log(`Resposta da IA pausada para a sessÃ£o ${sessionId}. Estado atual:`, isPaused[sessionId]);
 1051 â”‚   } catch (error) {
 1052 â”‚     console.error('Erro ao pausar resposta da IA:', error);
 1053 â”‚     throw error;
 1054 â”‚   }
 1055 â”‚ };
 1056 â”‚ 
 1057 â”‚ // FunÃ§Ã£o para verificar se a resposta estÃ¡ pausada
 1058 â”‚ export const isResponsePaused = (sessionId: string): boolean => {
 1059 â”‚   const paused = isPaused[sessionId] || false;
 1060 â”‚   // Para debugging
 1061 â”‚   if (paused) {
 1062 â”‚     console.log(`VerificaÃ§Ã£o de pausa: sessÃ£o ${sessionId} estÃ¡ pausada`);
 1063 â”‚   }
 1064 â”‚   return paused;
 1065 â”‚ };
 1066 â”‚ 
 1067 â”‚ // VariÃ¡vel para controlar se a resposta foi cancelada
 1068 â”‚ let isCancelled: Record<string, boolean> = {};
 1069 â”‚ 
 1070 â”‚ // FunÃ§Ã£o para cancelar a resposta da IA
 1071 â”‚ export const cancelResponse = async (sessionId: string): Promise<void> => {
 1072 â”‚   try {
 1073 â”‚     isCancelled[sessionId] = true;
 1074 â”‚     isPaused[sessionId] = false; // Certifique-se de que nÃ£o estÃ¡ em pausa tambÃ©m
 1075 â”‚     console.log(`Resposta da IA cancelada para a sessÃ£o ${sessionId}. Estado atual:`, isCancelled[sessionId]);
 1076 â”‚   } catch (error) {
 1077 â”‚     console.error('Erro ao cancelar resposta da IA:', error);
 1078 â”‚     throw error;
 1079 â”‚   }
 1080 â”‚ };
 1081 â”‚ 
 1082 â”‚ // FunÃ§Ã£o para verificar se a resposta foi cancelada
 1083 â”‚ export const isResponseCancelled = (sessionId: string): boolean => {
 1084 â”‚   const cancelled = isCancelled[sessionId] || false;
 1085 â”‚   // Para debugging
 1086 â”‚   if (cancelled) {
 1087 â”‚     console.log(`VerificaÃ§Ã£o de cancelamento: sessÃ£o ${sessionId} estÃ¡ cancelada`);
 1088 â”‚   }
 1089 â”‚   return cancelled;
 1090 â”‚ };
 1091 â”‚ 
 1092 â”‚ // FunÃ§Ã£o para retomar a resposta da IA
 1093 â”‚ export const resumeResponse = async (sessionId: string): Promise<void> => {
 1094 â”‚   try {
 1095 â”‚     isPaused[sessionId] = false;
 1096 â”‚     console.log(`Resposta da IA retomada para a sessÃ£o ${sessionId}. Estado atual:`, isPaused[sessionId]);
 1097 â”‚   } catch (error) {
 1098 â”‚     console.error('Erro ao retomar resposta da IA:', error);
 1099 â”‚     throw error;
 1100 â”‚   }
 1101 â”‚ };
 1102 â”‚ 
 1103 â”‚ // FunÃ§Ã£o para resetar o estado de cancelamento/pausa (Ãºtil ao iniciar novas respostas)
 1104 â”‚ export const resetResponseState = (sessionId: string): void => {
 1105 â”‚   const wasPaused = isPaused[sessionId];
 1106 â”‚   const wasCancelled = isCancelled[sessionId];
 1107 â”‚ 
 1108 â”‚   isPaused[sessionId] = false;
 1109 â”‚   isCancelled[sessionId] = false;
 1110 â”‚ 
 1111 â”‚   console.log(`Estados resetados para a sessÃ£o ${sessionId}. 
 1112 â”‚     Estado anterior: pausado=${wasPaused}, cancelado=${wasCancelled}. 
 1113 â”‚     Estado atual: pausado=${isPaused[sessionId]}, cancelado=${isCancelled[sessionId]}`);
 1114 â”‚ };
 1115 â”‚ 
 1116 â”‚ // Limpar histÃ³rico da conversa
 1117 â”‚ export function clearConversationHistory(sessionId: string): void {
 1118 â”‚   if (conversationHistory[sessionId]) {
 1119 â”‚     // MantÃ©m apenas a mensagem do sistema
 1120 â”‚     const systemMessage = conversationHistory[sessionId][0];
 1121 â”‚     conversationHistory[sessionId] = [systemMessage];
 1122 â”‚ 
 1123 â”‚     // Limpar do localStorage tambÃ©m
 1124 â”‚     try {
 1125 â”‚       localStorage.removeItem(`conversationHistory_${sessionId}`);
 1126 â”‚     } catch (error) {
 1127 â”‚       console.error("Erro ao limpar histÃ³rico do localStorage:", error);
 1128 â”‚     }
 1129 â”‚   }
 1130 â”‚ }
 1131 â”‚ 
 1132 â”‚ // Obter histÃ³rico da conversa
 1133 â”‚ export function getConversationHistory(sessionId: string): ChatMessage[] {
      Â·                 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      Â·                            â•°â”€â”€ `getConversationHistory` redefined here
 1134 â”‚   // Primeiro verifica se jÃ¡ estÃ¡ carregado na memÃ³ria
 1135 â”‚   if (conversationHistory[sessionId]) {
 1136 â”‚     return conversationHistory[sessionId];
      â•°â”€â”€â”€â”€

  Ã— the name `saveConversationHistory` is defined multiple times
      â•­â”€[/home/runner/workspace/src/services/aiChatService.ts:1015:1]
 1015 â”‚ 
 1016 â”‚ 
 1017 â”‚ // FunÃ§Ã£o para salvar o histÃ³rico da conversa no localStorage
 1018 â”‚ function saveConversationHistory(sessionId: string, history: ChatMessage[]): void {
      Â·          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      Â·                     â•°â”€â”€ previous definition of `saveConversationHistory` here
 1019 â”‚   try {
 1020 â”‚     localStorage.setItem(`conversationHistory_${sessionId}`, JSON.stringify(history));
 1021 â”‚   } catch (error) {
 1022 â”‚     console.error("Erro ao salvar o histÃ³rico da conversa:", error);
 1023 â”‚   }
 1024 â”‚ }
 1025 â”‚ 
 1026 â”‚ // SimulaÃ§Ã£o de resposta da IA
 1027 â”‚ const getResponseForMessage = (message: string): string => {
 1028 â”‚   // AnÃ¡lise bÃ¡sica da mensagem para gerar uma resposta contextual
 1029 â”‚   const formattedMessage = message.toLowerCase();
 1030 â”‚ 
 1031 â”‚   if (formattedMessage.includes('olÃ¡') || formattedMessage.includes('oi') || formattedMessage.includes('bom dia') || formattedMessage.includes('boa tarde') || formattedMessage.includes('boa noite')) {
 1032 â”‚     return `**OlÃ¡, ${userInfo?.username || 'amigo'}!** ðŸ˜Š\n\nComo posso ajudar vocÃª hoje?`;
 1033 â”‚   } else if (formattedMessage.includes('funÃ§Ã£o') || formattedMessage.includes('o que vocÃª faz') || formattedMessage.includes('para que serve')) {
 1034 â”‚     return `**Eu sou o Assistente de Suporte da Ponto.School**, aqui para te ajudar em tudo que precisar na plataforma! ðŸš€\n\nPosso ajudar com:\n\nâ€¢ **NavegaÃ§Ã£o:** Encontrar qualquer recurso na plataforma.\nâ€¢ **Tutoriais:** Explicar o funcionamento de qualquer ferramenta.\nâ€¢ **DÃºvidas:** Responder qualquer questÃ£o sobre a plataforma ou o conteÃºdo.\n\nComo posso ajudar vocÃª agora?`;
 1035 â”‚   } else if (formattedMessage.includes('portal') || formattedMessage.includes('material') || formattedMessage.includes('acessar conteÃºdo')) {
 1036 â”‚     return `VocÃª pode acessar o **Portal** com todos os materiais em https://pontoschool.com/portal\n\nLÃ¡ vocÃª encontrarÃ¡ todos os seus cursos, materiais e recursos de estudo organizados por disciplina.\n\n_Basta clicar no link acima para ir direto para o Portal!_ ðŸ“š`;
 1037 â”‚   } else {
 1038 â”‚     return "Desculpe, nÃ£o entendi sua pergunta. Pode reformulÃ¡-la?";
 1039 â”‚   }
 1040 â”‚ };
 1041 â”‚ 
 1042 â”‚ // VariÃ¡vel para controlar se a resposta estÃ¡ pausada
 1043 â”‚ let isPaused: Record<string, boolean> = {};
 1044 â”‚ 
 1045 â”‚ // FunÃ§Ã£o para pausar a resposta da IA
 1046 â”‚ export const pauseResponse = async (sessionId: string): Promise<void> => {
 1047 â”‚   try {
 1048 â”‚     isPaused[sessionId] = true;
 1049 â”‚     isCancelled[sessionId] = false; // Garantir que nÃ£o estÃ¡ cancelada
 1050 â”‚     console.log(`Resposta da IA pausada para a sessÃ£o ${sessionId}. Estado atual:`, isPaused[sessionId]);
 1051 â”‚   } catch (error) {
 1052 â”‚     console.error('Erro ao pausar resposta da IA:', error);
 1053 â”‚     throw error;
 1054 â”‚   }
 1055 â”‚ };
 1056 â”‚ 
 1057 â”‚ // FunÃ§Ã£o para verificar se a resposta estÃ¡ pausada
 1058 â”‚ export const isResponsePaused = (sessionId: string): boolean => {
 1059 â”‚   const paused = isPaused[sessionId] || false;
 1060 â”‚   // Para debugging
 1061 â”‚   if (paused) {
 1062 â”‚     console.log(`VerificaÃ§Ã£o de pausa: sessÃ£o ${sessionId} estÃ¡ pausada`);
 1063 â”‚   }
 1064 â”‚   return paused;
 1065 â”‚ };
 1066 â”‚ 
 1067 â”‚ // VariÃ¡vel para controlar se a resposta foi cancelada
 1068 â”‚ let isCancelled: Record<string, boolean> = {};
 1069 â”‚ 
 1070 â”‚ // FunÃ§Ã£o para cancelar a resposta da IA
 1071 â”‚ export const cancelResponse = async (sessionId: string): Promise<void> => {
 1072 â”‚   try {
 1073 â”‚     isCancelled[sessionId] = true;
 1074 â”‚     isPaused[sessionId] = false; // Certifique-se de que nÃ£o estÃ¡ em pausa tambÃ©m
 1075 â”‚     console.log(`Resposta da IA cancelada para a sessÃ£o ${sessionId}. Estado atual:`, isCancelled[sessionId]);
 1076 â”‚   } catch (error) {
 1077 â”‚     console.error('Erro ao cancelar resposta da IA:', error);
 1078 â”‚     throw error;
 1079 â”‚   }
 1080 â”‚ };
 1081 â”‚ 
 1082 â”‚ // FunÃ§Ã£o para verificar se a resposta foi cancelada
 1083 â”‚ export const isResponseCancelled = (sessionId: string): boolean => {
 1084 â”‚   const cancelled = isCancelled[sessionId] || false;
 1085 â”‚   // Para debugging
 1086 â”‚   if (cancelled) {
 1087 â”‚     console.log(`VerificaÃ§Ã£o de cancelamento: sessÃ£o ${sessionId} estÃ¡ cancelada`);
 1088 â”‚   }
 1089 â”‚   return cancelled;
 1090 â”‚ };
 1091 â”‚ 
 1092 â”‚ // FunÃ§Ã£o para retomar a resposta da IA
 1093 â”‚ export const resumeResponse = async (sessionId: string): Promise<void> => {
 1094 â”‚   try {
 1095 â”‚     isPaused[sessionId] = false;
 1096 â”‚     console.log(`Resposta da IA retomada para a sessÃ£o ${sessionId}. Estado atual:`, isPaused[sessionId]);
 1097 â”‚   } catch (error) {
 1098 â”‚     console.error('Erro ao retomar resposta da IA:', error);
 1099 â”‚     throw error;
 1100 â”‚   }
 1101 â”‚ };
 1102 â”‚ 
 1103 â”‚ // FunÃ§Ã£o para resetar o estado de cancelamento/pausa (Ãºtil ao iniciar novas respostas)
 1104 â”‚ export const resetResponseState = (sessionId: string): void => {
 1105 â”‚   const wasPaused = isPaused[sessionId];
 1106 â”‚   const wasCancelled = isCancelled[sessionId];
 1107 â”‚ 
 1108 â”‚   isPaused[sessionId] = false;
 1109 â”‚   isCancelled[sessionId] = false;
 1110 â”‚ 
 1111 â”‚   console.log(`Estados resetados para a sessÃ£o ${sessionId}. 
 1112 â”‚     Estado anterior: pausado=${wasPaused}, cancelado=${wasCancelled}. 
 1113 â”‚     Estado atual: pausado=${isPaused[sessionId]}, cancelado=${isCancelled[sessionId]}`);
 1114 â”‚ };
 1115 â”‚ 
 1116 â”‚ // Limpar histÃ³rico da conversa
 1117 â”‚ export function clearConversationHistory(sessionId: string): void {
 1118 â”‚   if (conversationHistory[sessionId]) {
 1119 â”‚     // MantÃ©m apenas a mensagem do sistema
 1120 â”‚     const systemMessage = conversationHistory[sessionId][0];
 1121 â”‚     conversationHistory[sessionId] = [systemMessage];
 1122 â”‚ 
 1123 â”‚     // Limpar do localStorage tambÃ©m
 1124 â”‚     try {
 1125 â”‚       localStorage.removeItem(`conversationHistory_${sessionId}`);
 1126 â”‚     } catch (error) {
 1127 â”‚       console.error("Erro ao limpar histÃ³rico do localStorage:", error);
 1128 â”‚     }
 1129 â”‚   }
 1130 â”‚ }
 1131 â”‚ 
 1132 â”‚ // Obter histÃ³rico da conversa
 1133 â”‚ export function getConversationHistory(sessionId: string): ChatMessage[] {
 1134 â”‚   // Primeiro verifica se jÃ¡ estÃ¡ carregado na memÃ³ria
 1135 â”‚   if (conversationHistory[sessionId]) {
 1136 â”‚     return conversationHistory[sessionId];
 1137 â”‚   }
 1138 â”‚ 
 1139 â”‚   // Caso contrÃ¡rio, tenta recuperar do localStorage
 1140 â”‚   try {
 1141 â”‚     const savedHistory = localStorage.getItem(`conversationHistory_${sessionId}`);
 1142 â”‚     if (savedHistory) {
 1143 â”‚       const parsedHistory = JSON.parse(savedHistory) as ChatMessage[];
 1144 â”‚       conversationHistory[sessionId] = parsedHistory;
 1145 â”‚       return parsedHistory;
 1146 â”‚     }
 1147 â”‚   } catch (error) {
 1148 â”‚     console.error("Erro ao recuperar histÃ³rico do localStorage:", error);
 1149 â”‚   }
 1150 â”‚ 
 1151 â”‚   return [];
 1152 â”‚ }
 1153 â”‚ 
 1154 â”‚ // FunÃ§Ã£o para salvar o histÃ³rico da conversa no localStorage
 1155 â”‚ function saveConversationHistory(sessionId: string, history: ChatMessage[]): void {
      Â·          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      Â·                     â•°â”€â”€ `saveConversationHistory` redefined here
 1156 â”‚   try {
 1157 â”‚     localStorage.setItem(`conversationHistory_${sessionId}`, JSON.stringify(history));
 1158 â”‚   } catch (error) {
      â•°â”€â”€â”€â”€
/home/runner/workspace/src/services/aiChatService.ts:887:1