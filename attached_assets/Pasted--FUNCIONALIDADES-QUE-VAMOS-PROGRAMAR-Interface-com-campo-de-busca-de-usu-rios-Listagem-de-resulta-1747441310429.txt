ðŸ”§ FUNCIONALIDADES QUE VAMOS PROGRAMAR
Interface com campo de busca de usuÃ¡rios

Listagem de resultados com botÃ£o "Adicionar"

Envio de solicitaÃ§Ã£o de amizade

Banco de dados: estrutura de amizades no Supabase

VerificaÃ§Ã£o de status da amizade (jÃ¡ enviado, aceito, pendente)

AtualizaÃ§Ã£o em tempo real (opcional)

Feedback visual no botÃ£o (adicionado / pendente)

ðŸ—‚ ESTRUTURA NO SUPABASE (TABELAS)
ðŸ§‘â€ðŸ¤â€ðŸ§‘ friend_requests
Campo	Tipo	DescriÃ§Ã£o
id	UUID (PK)	ID Ãºnico da solicitaÃ§Ã£o
sender_id	UUID	ID do usuÃ¡rio que enviou
receiver_id	UUID	ID do usuÃ¡rio que recebeu
status	text	pending, accepted, rejected
created_at	timestamp	Data da solicitaÃ§Ã£o

Importante: VocÃª jÃ¡ tem a tabela users, que usaremos para busca.

ðŸ–¥ï¸ FRONT-END (REACT + SUPABASE)
1. Componente AddFriendModal.jsx
jsx
Copiar
Editar
import { useState, useEffect } from "react";
import { createClient } from '@supabase/supabase-js';

const supabase = createClient('https://YOUR_PROJECT.supabase.co', 'YOUR_ANON_KEY');

export default function AddFriendModal({ currentUserId, onClose }) {
  const [searchTerm, setSearchTerm] = useState("");
  const [results, setResults] = useState([]);
  const [sentRequests, setSentRequests] = useState({});

  // Busca usuÃ¡rios com base no termo digitado
  useEffect(() => {
    const fetchUsers = async () => {
      if (searchTerm.length < 3) return;

      const { data, error } = await supabase
        .from('users')
        .select('id, username, avatar_url') // ajuste conforme seu schema
        .ilike('username', `%${searchTerm}%`)
        .neq('id', currentUserId);

      if (!error) setResults(data);
    };

    const timeout = setTimeout(fetchUsers, 500); // debounce
    return () => clearTimeout(timeout);
  }, [searchTerm]);

  const sendFriendRequest = async (receiverId) => {
    const { data, error } = await supabase
      .from('friend_requests')
      .insert([{ sender_id: currentUserId, receiver_id: receiverId, status: 'pending' }]);

    if (!error) {
      setSentRequests(prev => ({ ...prev, [receiverId]: 'pending' }));
    }
  };

  const checkExistingRequests = async () => {
    const { data, error } = await supabase
      .from('friend_requests')
      .select('receiver_id, status')
      .eq('sender_id', currentUserId);

    if (!error) {
      const statusMap = {};
      data.forEach(req => {
        statusMap[req.receiver_id] = req.status;
      });
      setSentRequests(statusMap);
    }
  };

  useEffect(() => {
    checkExistingRequests();
  }, []);

  return (
    <div className="modal">
      <h2>Adicionar amigo</h2>
      <input
        type="text"
        placeholder="Buscar por nome de usuÃ¡rio..."
        value={searchTerm}
        onChange={(e) => setSearchTerm(e.target.value)}
        className="input"
      />

      <ul className="user-list">
        {results.map(user => (
          <li key={user.id} className="user-item">
            <img src={user.avatar_url} alt="Avatar" className="avatar" />
            <span>{user.username}</span>

            {sentRequests[user.id] === 'pending' ? (
              <button className="btn-pending" disabled>Solicitado</button>
            ) : (
              <button className="btn-add" onClick={() => sendFriendRequest(user.id)}>
                Adicionar
              </button>
            )}
          </li>
        ))}
      </ul>

      <button className="close-btn" onClick={onClose}>Fechar</button>
    </div>
  );
}