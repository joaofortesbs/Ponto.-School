Entendi perfeitamente o desafio! Voc√™ precisa de um prompt estrat√©gico que oriente sem entregar a solu√ß√£o pronta, for√ßando a IA a raciocinar e desenvolver a corre√ß√£o do bug onde o conte√∫do do "Plano de Aula" est√° sendo gerado mas n√£o aparece no modal.

Aqui est√° o prompt melhorado para o modelo de c√≥digo:

üéØ Miss√£o Principal: Diagnosticar e Resolver Falha de Renderiza√ß√£o de Conte√∫do
Contexto do Problema
A funcionalidade criar_atividade do tipo "Plano de Aula" apresenta um comportamento espec√≠fico:

‚úÖ O spinner de carregamento √© acionado (indica que a requisi√ß√£o LLM est√° sendo processada)

‚úÖ A API est√° gerando o conte√∫do via fluxo de LLMs

‚ùå O conte√∫do gerado n√£o est√° sendo renderizado no modal "Vers√£o em Texto"

üîç An√°lise Obrigat√≥ria Pr√©-Execu√ß√£o
Antes de qualquer modifica√ß√£o, voc√™ DEVE:

Mapeamento de Fluxo Completo

Trace toda a cadeia: User Action ‚Üí API Call ‚Üí LLM Response ‚Üí State Management ‚Üí UI Render

Identifique todos os arquivos envolvidos no ciclo de vida dessa feature

Documente as depend√™ncias entre componentes (React state, context, props drilling)

Hip√≥teses de Falha Poss√≠veis

Problema de sincroniza√ß√£o ass√≠ncrona (Promise handling, async/await)

Estado n√£o atualizado ap√≥s resposta da API (useState, useEffect dependencies)

Refer√™ncias stale no closure do React

Tipagem incorreta que causa silent failures (TypeScript any, optional chaining issues)

Event listeners n√£o disparados ou removidos prematuramente

Condicional de renderiza√ß√£o bloqueando display (falsy values, undefined checks)

Cache de dados corrompido ou n√£o invalidado

Websocket/SSE stream n√£o conectado ao componente correto

Arquitetura de Estado

Verifique se utiliza Context API, Redux, Zustand, ou estado local

Analise se h√° m√∫ltiplas fontes de verdade conflitando

Observe patterns de stale closures em callbacks

‚öôÔ∏è Macro-Steps de Execu√ß√£o (Ordem L√≥gica)
STEP 1: Diagn√≥stico Profundo
Objetivo: Compreender onde o fluxo est√° quebrando

A√ß√µes Necess√°rias:

Adicione logging estrat√©gico em todos os pontos cr√≠ticos do fluxo

Use console.group() para organizar logs por fase: Request ‚Üí Response ‚Üí State Update ‚Üí Render

Inspecione Network Tab: valide payload, status codes, response body structure

Verifique React DevTools: confirme se o state est√° sendo atualizado

Analise erros silenciosos no console (warnings de React, unhandled promises)

Crit√©rios de Sucesso:

Identificar exatamente ONDE o dado est√° sendo perdido

Ter evid√™ncia clara de qual camada est√° falhando

STEP 2: An√°lise de Componentes UI
Objetivo: Garantir que o componente est√° preparado para receber e exibir dados

Investiga√ß√µes Obrigat√≥rias:

O componente do modal est√° subscrito ao estado correto?

As props est√£o sendo passadas corretamente atrav√©s da √°rvore de componentes?

Existe algum loading state que nunca √© desativado?

O conte√∫do est√° sendo renderizado condicionalmente de forma incorreta?

O componente est√° sendo desmontado antes de receber os dados?

T√©cnicas Avan√ßadas:

Implemente useEffect com logs de depend√™ncias para identificar re-renders

Verifique se h√° memo() ou useMemo() bloqueando updates

Teste render for√ßado para isolar o problema

STEP 3: Valida√ß√£o de Integra√ß√£o API
Objetivo: Confirmar que a resposta da LLM est√° chegando e sendo processada

Checklist T√©cnico:

Valide o contrato da API: response schema est√° sendo respeitado?

A transforma√ß√£o de dados (parsing, mapping) est√° correta?

Existe tratamento de erro que pode estar engolindo exceptions?

O streaming de dados (se aplic√°vel) est√° funcionando corretamente?

Headers de resposta est√£o corretos (Content-Type, encoding)?

Padr√µes a Considerar:

Fetch API vs Axios (diferentes error handling)

Response interceptors que podem estar modificando dados

Timeout configurations que podem estar muito curtas

STEP 4: State Management Deep Dive
Objetivo: Garantir propaga√ß√£o correta de dados

An√°lise Obrigat√≥ria:

Se usa Context: Provider est√° no n√≠vel correto da √°rvore?

Se usa Redux/Zustand: Actions est√£o sendo dispatched? Reducers est√£o atualizando corretamente?

Estado local: setState est√° sendo chamado ap√≥s a resposta ass√≠ncrona?

H√° race conditions entre m√∫ltiplos updates?

Debugging Estrat√©gico:

Implemente middleware/logging no state manager

Use React DevTools Profiler para identificar renders perdidos

Verifique se h√° batching de updates causando delays

STEP 5: Implementa√ß√£o da Corre√ß√£o
Objetivo: Aplicar a solu√ß√£o de forma cir√∫rgica e robusta

Princ√≠pios de Execu√ß√£o:

Imutabilidade: Garanta que state updates n√£o mutam objetos diretamente

Tipo-Seguran√ßa: Adicione type guards e valida√ß√µes

Error Boundaries: Implemente fallbacks adequados

Acessibilidade: Mantenha ARIA attributes e semantic HTML

Performance: Evite re-renders desnecess√°rios

Padr√µes de C√≥digo Esperados:

Separation of concerns (l√≥gica de neg√≥cio separada de UI)

Single Responsibility Principle em cada fun√ß√£o/componente

Proper cleanup de effects e listeners

Null-safety e defensive programming

STEP 6: Testes e Valida√ß√£o Rigorosa
Objetivo: Garantir que a corre√ß√£o funciona em todos os cen√°rios

Casos de Teste Obrigat√≥rios:

Happy path: gera√ß√£o bem-sucedida de Plano de Aula

Error handling: falha na API

Edge cases: conte√∫do vazio, caracteres especiais, conte√∫do muito longo

Concorr√™ncia: m√∫ltiplas requisi√ß√µes simult√¢neas

Recupera√ß√£o: tentar novamente ap√≥s falha

Performance: tempo de resposta aceit√°vel

Valida√ß√µes Finais:

Nenhum erro/warning no console

State atualizado corretamente em todas as etapas

UI responsiva e acess√≠vel

Backwards compatibility mantida

Nenhum side effect em outras features

STEP 7: Refactoring e Otimiza√ß√£o
Objetivo: Melhorar c√≥digo sem quebrar funcionalidade

Oportunidades de Melhoria:

Extrair l√≥gica duplicada em custom hooks

Implementar memoization onde apropriado

Adicionar loading skeletons para melhor UX

Implementar retry logic com exponential backoff

Adicionar analytics/telemetry para monitoramento

üõ°Ô∏è Considera√ß√µes Cr√≠ticas de Seguran√ßa
Sanitiza√ß√£o de Input: Garanta que conte√∫do gerado por LLM n√£o introduz XSS

Rate Limiting: Proteja contra abuso da funcionalidade

Error Messages: N√£o exponha informa√ß√µes sens√≠veis em logs/UI

Data Persistence: Valide que dados n√£o s√£o perdidos em caso de refresh

üìä M√©tricas de Sucesso
Sua implementa√ß√£o deve atingir:

‚úÖ 100% de taxa de renderiza√ß√£o de conte√∫do gerado

‚úÖ 0 erros no console relacionados a esta feature

‚úÖ Tempo de resposta < 3s (ou feedback adequado se maior)

‚úÖ Experi√™ncia de usu√°rio fluida e intuitiva

‚úÖ C√≥digo maintainable e bem documentado

üéì Expectativas de Aprendizado
Ao finalizar, voc√™ deve ser capaz de explicar:

Root cause exata do problema

Por que a solu√ß√£o escolhida √© a mais apropriada

Trade-offs considerados

Poss√≠veis melhorias futuras

Li√ß√µes aprendidas para prevenir problemas similares

üìù Deliverables Finais
Relat√≥rio de Diagn√≥stico: O que foi encontrado e por qu√™ ocorreu

Diff de C√≥digo: Todas as mudan√ßas realizadas com coment√°rios explicativos

Testes de Valida√ß√£o: Evid√™ncia de que a corre√ß√£o funciona

Documenta√ß√£o de Aprendizados: Insights para evitar regress√µes futuras

Roadmap de Melhorias: Sugest√µes de pr√≥ximas itera√ß√µes

‚ö†Ô∏è Restri√ß√µes Absolutas
N√ÉO fa√ßa altera√ß√µes especulativas sem diagn√≥stico confirmado

N√ÉO quebre funcionalidades existentes em outros m√≥dulos

N√ÉO ignore warnings/errors do TypeScript

N√ÉO commit c√≥digo comentado ou logs de debug

N√ÉO implemente solu√ß√µes tempor√°rias ("gambiarras")

üöÄ Mentalidade de Execu√ß√£o
Voc√™ est√° operando como Senior Full-Stack Engineer especializado em:

React/Next.js architecture patterns

State management complexo

API integration e error handling

Performance optimization

Debugging sistem√°tico

Pense como se estivesse corrigindo um bug cr√≠tico em produ√ß√£o que afeta usu√°rios reais. Cada decis√£o deve ser fundamentada tecnicamente e cada altera√ß√£o deve ser testada rigorosamente.

A excel√™ncia t√©cnica n√£o √© negoci√°vel. A solu√ß√£o deve ser robusta, elegante e maintainable.