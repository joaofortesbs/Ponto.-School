[plugin:vite:react-swc] Ã— the name `selectedEvent` is defined multiple times
     â•­â”€[/home/runner/workspace/src/pages/agenda/index.tsx:107:1]
 107 â”‚   const [showEpictusAIModal, setShowEpictusAIModal] = useState(false);
 108 â”‚   const [showEpictusCalendarModal, setShowEpictusCalendarModal] =
 109 â”‚     useState(false);
 110 â”‚   const [selectedEvent, setSelectedEvent] = useState<CalendarEvent | null>(null);
     Â·          â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€
     Â·                â•°â”€â”€ previous definition of `selectedEvent` here
 111 â”‚   const [showSetGoalModal, setShowSetGoalModal] = useState(false);
 112 â”‚   const [showAddTaskModal, setShowAddTaskModal] = useState(false);
 113 â”‚   const [showAISuggestionsModal, setShowAISuggestionsModal] = useState(false);
 114 â”‚   const [tasksData, setTasksData] = useState([
 115 â”‚     {
 116 â”‚       id: "1",
 117 â”‚       title: "Lista de ExercÃ­cios - FunÃ§Ãµes TrigonomÃ©tricas",
 118 â”‚       discipline: "MatemÃ¡tica",
 119 â”‚       dueDate: "Vence hoje, 18:00",
 120 â”‚       progress: 75,
 121 â”‚       urgent: true,
 122 â”‚       priority: "alta",
 123 â”‚     },
 124 â”‚     {
 125 â”‚       id: "2",
 126 â”‚       title: "RelatÃ³rio de Experimento - TitulaÃ§Ã£o",
 127 â”‚       discipline: "QuÃ­mica",
 128 â”‚       dueDate: "Vence em 2 dias",
 129 â”‚       progress: 30,
 130 â”‚       urgent: false,
 131 â”‚       priority: "mÃ©dia",
 132 â”‚     },
 133 â”‚     {
 134 â”‚       id: "3",
 135 â”‚       title: "PreparaÃ§Ã£o para Prova - MecÃ¢nica QuÃ¢ntica",
 136 â”‚       discipline: "FÃ­sica",
 137 â”‚       dueDate: "Vence em 1 dia",
 138 â”‚       progress: 10,
 139 â”‚       urgent: true,
 140 â”‚       priority: "alta",
 141 â”‚     },
 142 â”‚   ]);
 143 â”‚ 
 144 â”‚   // Get current date for calendar
 145 â”‚   const currentDate = new Date();
 146 â”‚   const currentDay = currentDate.getDate();
 147 â”‚   const currentMonth = currentDate.getMonth();
 148 â”‚   const currentYear = currentDate.getFullYear();
 149 â”‚ 
 150 â”‚   // Update URL when active tab changes
 151 â”‚   useEffect(() => {
 152 â”‚     setSearchParams({ view: activeTab });
 153 â”‚   }, [activeTab, setSearchParams]);
 154 â”‚ 
 155 â”‚   // Update active tab when URL changes
 156 â”‚   useEffect(() => {
 157 â”‚     if (viewParam) {
 158 â”‚       setActiveTab(viewParam);
 159 â”‚     }
 160 â”‚   }, [viewParam]);
 161 â”‚ 
 162 â”‚   // Dados de eventos para o calendÃ¡rio (vazio por padrÃ£o)
 163 â”‚   const [eventData, setEventData] = useState<Record<number, any[]>>({});
 164 â”‚ 
 165 â”‚   // FunÃ§Ã£o para formatar eventos prÃ³ximos a partir do eventData
 166 â”‚   const getUpcomingEvents = () => {
 167 â”‚     const today = new Date();
 168 â”‚     today.setHours(0, 0, 0, 0); // Normaliza a data atual para comparaÃ§Ã£o
 169 â”‚     const upcoming: any[] = [];
 170 â”‚ 
 171 â”‚     // Percorre todos os dias com eventos
 172 â”‚     Object.keys(eventData).forEach(day => {
 173 â”‚       const dayEvents = eventData[parseInt(day)] || [];
 174 â”‚ 
 175 â”‚       // Para cada evento nesse dia
 176 â”‚       dayEvents.forEach(event => {
 177 â”‚         if (event.startDate) {
 178 â”‚           const eventDate = new Date(event.startDate);
 179 â”‚           eventDate.setHours(0, 0, 0, 0); // Normaliza a data do evento para comparaÃ§Ã£o
 180 â”‚ 
 181 â”‚           // Adiciona eventos que ocorrem hoje ou no futuro
 182 â”‚           if (eventDate >= today) {
 183 â”‚             // Formata a data com date-fns
 184 â”‚             const formattedDate = format(eventDate, "dd/MM/yyyy", { locale: ptBR });
 185 â”‚ 
 186 â”‚             upcoming.push({
 187 â”‚               id: event.id,
 188 â”‚               type: event.type,
 189 â”‚               title: event.title,
 190 â”‚               day: formattedDate,
 191 â”‚               discipline: event.discipline || "Geral",
 192 â”‚               isOnline: event.isOnline || false,
 193 â”‚               color: event.color,
 194 â”‚               details: event.details,
 195 â”‚               startTime: event.startTime || event.time || "00:00",
 196 â”‚               // Guardar a data original para ordenaÃ§Ã£o
 197 â”‚               originalDate: eventDate,
 198 â”‚               originalTime: event.startTime || event.time || "00:00"
 199 â”‚             });
 200 â”‚           }
 201 â”‚         }
 202 â”‚       });
 203 â”‚     });
 204 â”‚ 
 205 â”‚     // Ordena eventos cronologicamente (por data e hora)
 206 â”‚     upcoming.sort((a, b) => {
 207 â”‚       // Primeiro compara por data
 208 â”‚       const dateComparison = a.originalDate.getTime() - b.originalDate.getTime();
 209 â”‚ 
 210 â”‚       // Se for a mesma data, compara pelo horÃ¡rio
 211 â”‚       if (dateComparison === 0) {
 212 â”‚         const [hoursA, minutesA] = a.originalTime.split(':').map(Number);
 213 â”‚         const [hoursB, minutesB] = b.originalTime.split(':').map(Number);
 214 â”‚ 
 215 â”‚         // Compara horas
 216 â”‚         if (hoursA !== hoursB) {
 217 â”‚           return hoursA - hoursB;
 218 â”‚         }
 219 â”‚ 
 220 â”‚         // Se as horas forem iguais, compara minutos
 221 â”‚         return minutesA - minutesB;
 222 â”‚       }
 223 â”‚ 
 224 â”‚       return dateComparison;
 225 â”‚     });
 226 â”‚ 
 227 â”‚     return upcoming;
 228 â”‚   };
 229 â”‚ 
 230 â”‚   // Array de eventos prÃ³ximos atualizado a partir do eventData
 231 â”‚   const upcomingEventsData = getUpcomingEvents();
 232 â”‚ 
 233 â”‚   // Sample AI recommendations
 234 â”‚   const aiRecommendations = [
 235 â”‚     {
 236 â”‚       id: "1",
 237 â”‚       priority: "high",
 238 â”‚       title: "Prioridade Alta: VocÃª tem uma prova de FÃ­sica amanhÃ£",
 239 â”‚       description:
 240 â”‚         "Recomendo revisar os conceitos de MecÃ¢nica QuÃ¢ntica hoje Ã  noite.",
 241 â”‚       actions: [
 242 â”‚         {
 243 â”‚           label: "Ver Material",
 244 â”‚           icon: <FileText className="h-3.5 w-3.5 mr-1" />,
 245 â”‚           variant: "outline",
 246 â”‚         },
 247 â”‚         {
 248 â”‚           label: "Criar Resumo",
 249 â”‚           icon: <FileEdit className="h-3.5 w-3.5 mr-1" />,
 250 â”‚           variant: "default",
 251 â”‚         },
 252 â”‚       ],
 253 â”‚       icon: <AlertCircle className="h-5 w-5 text-red-500" />,
 254 â”‚     },
 255 â”‚     {
 256 â”‚       id: "2",
 257 â”‚       priority: "medium",
 258 â”‚       title: "Seu desempenho em QuÃ­mica caiu 15% na Ãºltima semana",
 259 â”‚       description: "Que tal revisar os conceitos de titulaÃ§Ã£o?",
 260 â”‚       actions: [
 261 â”‚         {
 262 â”‚           label: "Ver Desempenho",
 263 â”‚           icon: <LineChart className="h-3.5 w-3.5 mr-1" />,
 264 â”‚           variant: "outline",
 265 â”‚         },
 266 â”‚         {
 267 â”‚           label: "Praticar ExercÃ­cios",
 268 â”‚           icon: <CheckSquare className="h-3.5 w-3.5 mr-1" />,
 269 â”‚           variant: "default",
 270 â”‚         },
 271 â”‚       ],
 272 â”‚       icon: <Flame className="h-5 w-5 text-amber-500" />,
 273 â”‚     },
 274 â”‚     {
 275 â”‚       id: "3",
 276 â”‚       priority: "low",
 277 â”‚       title: "VocÃª estÃ¡ com uma sequÃªncia de 7 dias de estudo!",
 278 â”‚       description: "Continue assim para ganhar mais pontos de experiÃªncia.",
 279 â”‚       actions: [
 280 â”‚         {
 281 â”‚           label: "Ver Conquistas",
 282 â”‚           icon: <Trophy className="h-3.5 w-3.5 mr-1" />,
 283 â”‚           variant: "outline",
 284 â”‚         },
 285 â”‚       ],
 286 â”‚       icon: <Zap className="h-5 w-5 text-green-500" />,
 287 â”‚     },
 288 â”‚   ];
 289 â”‚ 
 290 â”‚   // Sample study time data
 291 â”‚   const studyTimeData = {
 292 â”‚     total: 32,
 293 â”‚     goal: 40,
 294 â”‚     progress: 80, // 32/40 = 80%
 295 â”‚     byDay: [
 296 â”‚       { day: "Seg", hours: 5 },
 297 â”‚       { day: "Ter", hours: 6 },
 298 â”‚       { day: "Qua", hours: 4 },
 299 â”‚       { day: "Qui", hours: 7 },
 300 â”‚       { day: "Sex", hours: 5 },
 301 â”‚       { day: "SÃ¡b", hours: 3 },
 302 â”‚       { day: "Dom", hours: 2 },
 303 â”‚     ],
 304 â”‚     bySubject: [
 305 â”‚       { subject: "MatemÃ¡tica", hours: 10, color: "#FF6B00" },
 306 â”‚       { subject: "FÃ­sica", hours: 8, color: "#FF8C40" },
 307 â”‚       { subject: "QuÃ­mica", hours: 6, color: "#E85D04" },
 308 â”‚       { subject: "Biologia", hours: 5, color: "#DC2F02" },
 309 â”‚       { subject: "HistÃ³ria", hours: 3, color: "#9D0208" },
 310 â”‚     ],
 311 â”‚   };
 312 â”‚ 
 313 â”‚   // Sample last accessed classes
 314 â”‚   const lastAccessedClasses = [
 315 â”‚     {
 316 â”‚       id: "1",
 317 â”‚       title: "FunÃ§Ãµes TrigonomÃ©tricas",
 318 â”‚       discipline: "MatemÃ¡tica",
 319 â”‚       professor: "Prof. Carlos Santos",
 320 â”‚       progress: 75,
 321 â”‚       thumbnail:
 322 â”‚         "https://images.unsplash.com/photo-1635070041078-e363dbe005cb?w=300&q=80",
 323 â”‚       lastAccessed: "Hoje, 10:30",
 324 â”‚     },
 325 â”‚     {
 326 â”‚       id: "2",
 327 â”‚       title: "MecÃ¢nica QuÃ¢ntica - IntroduÃ§Ã£o",
 328 â”‚       discipline: "FÃ­sica",
 329 â”‚       professor: "Prof. Roberto Alves",
 330 â”‚       progress: 45,
 331 â”‚       thumbnail:
 332 â”‚         "https://images.unsplash.com/photo-1636466497217-26a8cbeaf0aa?w=300&q=80",
 333 â”‚       lastAccessed: "Ontem, 15:20",
 334 â”‚     },
 335 â”‚     {
 336 â”‚       id: "3",
 337 â”‚       title: "TitulaÃ§Ã£o e pH",
 338 â”‚       discipline: "QuÃ­mica",
 339 â”‚       professor: "Profa. Ana Martins",
 340 â”‚       progress: 90,
 341 â”‚       thumbnail:
 342 â”‚         "https://images.unsplash.com/photo-1603126857599-f6e157fa2fe6?w=300&q=80",
 343 â”‚       lastAccessed: "2 dias atrÃ¡s, 14:15",
 344 â”‚     },
 345 â”‚   ];
 346 â”‚ 
 347 â”‚   // Sample ranking data
 348 â”‚   const rankingData = {
 349 â”‚     position: 42,
 350 â”‚     total: 210,
 351 â”‚     points: 3750,
 352 â”‚     nextReward: 4000,
 353 â”‚     progress: 75, // (3750/4000)*100 = 93.75%
 354 â”‚     trend: "+5", // Subiu 5 posiÃ§Ãµes
 355 â”‚   };
 356 â”‚ 
 357 â”‚   // Sample subject progress data
 358 â”‚   const subjectProgressData = [
 359 â”‚     { subject: "MatemÃ¡tica", progress: 85, goal: 90, color: "#FF6B00" },
 360 â”‚     { subject: "FÃ­sica", progress: 72, goal: 80, color: "#FF8C40" },
 361 â”‚     { subject: "QuÃ­mica", progress: 65, goal: 75, color: "#E85D04" },
 362 â”‚     { subject: "Biologia", progress: 90, goal: 85, color: "#DC2F02" },
 363 â”‚     { subject: "HistÃ³ria", progress: 78, goal: 80, color: "#9D0208" },
 364 â”‚   ];
 365 â”‚ 
 366 â”‚   // Sample today's events data
 367 â”‚   const todayEventsData = [
 368 â”‚     {
 369 â”‚       id: "1",
 370 â”‚       type: "aula",
 371 â”‚       title: "Aula de MatemÃ¡tica",
 372 â”‚       time: "10:00 - 11:30",
 373 â”‚       status: "agora",
 374 â”‚       discipline: "MatemÃ¡tica",
 375 â”‚       isOnline: true,
 376 â”‚     },
 377 â”‚     {
 378 â”‚       id: "2",
 379 â”‚       type: "trabalho",
 380 â”‚       title: "Entrega de Trabalho",
 381 â”‚       time: "atÃ© 18:00",
 382 â”‚       status: "pendente",
 383 â”‚       discipline: "QuÃ­mica",
 384 â”‚       isOnline: true,
 385 â”‚     },
 386 â”‚   ];
 387 â”‚ 
 388 â”‚   // Get event icon based on type
 389 â”‚   const getEventIcon = (type: string) => {
 390 â”‚     switch (type) {
 391 â”‚       case "aula":
 392 â”‚         return <Video className="h-4 w-4" />;
 393 â”‚       case "trabalho":
 394 â”‚         return <FileEdit className="h-4 w-4" />;
 395 â”‚       case "prova":
 396 â”‚         return <AlertCircle className="h-4 w-4" />;
 397 â”‚       case "reuniao":
 398 â”‚         return <Users className="h-4 w-4" />;
 399 â”‚       case "lembrete":
 400 â”‚         return <Bell className="h-4 w-4" />;
 401 â”‚       case "tarefa":
 402 â”‚         return <CheckSquare className="h-4 w-4" />;
 403 â”‚       default:
 404 â”‚         return <CalendarIcon className="h-4 w-4" />;
 405 â”‚     }
 406 â”‚   };
 407 â”‚ 
 408 â”‚   // Get event color based on type
 409 â”‚   const getEventColor = (type: string) => {
 410 â”‚     switch (type) {
 411 â”‚       case "aula":
 412 â”‚         return "blue";
 413 â”‚       case "trabalho":
 414 â”‚       case "tarefa":
 415 â”‚         return "amber";
 416 â”‚       case "prova":
 417 â”‚         return "red";
 418 â”‚       case "reuniao":
 419 â”‚         return "green";
 420 â”‚       case "lembrete":
 421 â”‚         return "yellow";
 422 â”‚       case "evento":
 423 â”‚         return "purple";
 424 â”‚       default:
 425 â”‚         return "gray";
 426 â”‚     }
 427 â”‚   };
 428 â”‚ 
 429 â”‚   // Get task icon based on type
 430 â”‚   const getTaskIcon = (discipline: string) => {
 431 â”‚     switch (discipline) {
 432 â”‚       case "MatemÃ¡tica":
 433 â”‚         return <span className="text-[#FF6B00] font-bold">Ï€</span>;
 434 â”‚       case "FÃ­sica":
 435 â”‚         return <span className="text-[#FF8C40] font-bold">âš›</span>;
 436 â”‚       case "QuÃ­mica":
 437 â”‚         return <span className="text-[#E85D04] font-bold">âš—</span>;
 438 â”‚       case "Biologia":
 439 â”‚         return <span className="text-[#DC2F02] font-bold">ðŸ§¬</span>;
 440 â”‚       case "HistÃ³ria":
 441 â”‚         return <span className="text-[#9D0208] font-bold">ðŸ“œ</span>;
 442 â”‚       default:
 443 â”‚         return <BookOpen className="h-4 w-4" />;
 444 â”‚     }
 445 â”‚   };
 446 â”‚ 
 447 â”‚   // Get priority badge color
 448 â”‚   const getPriorityColor = (priority: string) => {
 449 â”‚     switch (priority) {
 450 â”‚       case "alta":
 451 â”‚         return "bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";
 452 â”‚       case "mÃ©dia":
 453 â”‚         return "bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-300";
 454 â”‚       case "baixa":
 455 â”‚         return "bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";
 456 â”‚       default:
 457 â”‚         return "bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300";
 458 â”‚     }
 459 â”‚   };
 460 â”‚ 
 461 â”‚   // Get status badge color
 462 â”‚   const getStatusBadge = (status: string) => {
 463 â”‚     switch (status) {
 464 â”‚       case "agora":
 465 â”‚         return <Badge className="bg-green-500 text-white">Agora</Badge>;
 466 â”‚       case "pendente":
 467 â”‚         return <Badge className="bg-amber-500 text-white">Pendente</Badge>;
 468 â”‚       default:
 469 â”‚         return null;
 470 â”‚     }
 471 â”‚   };
 472 â”‚ 
 473 â”‚   // Handle search input
 474 â”‚   const handleSearchInput = (e: React.ChangeEvent<HTMLInputElement>) => {
 475 â”‚     const query = e.target.value;
 476 â”‚     setSearchQuery(query);
 477 â”‚ 
 478 â”‚     if (query.length > 2) {
 479 â”‚       // Simulate search suggestions
 480 â”‚       const suggestions = [
 481 â”‚         "Aula de MatemÃ¡tica",
 482 â”‚         "Prova de FÃ­sica",
 483 â”‚         "Grupo de Estudos",
 484 â”‚         "Entrega de Trabalho",
 485 â”‚         "MatemÃ¡tica",
 486 â”‚         "FÃ­sica",
 487 â”‚         "Prof. Carlos Santos",
 488 â”‚       ].filter((item) => item.toLowerCase().includes(query.toLowerCase()));
 489 â”‚ 
 490 â”‚       setSearchSuggestions(suggestions);
 491 â”‚       setShowSearchSuggestions(suggestions.length > 0);
 492 â”‚     } else {
 493 â”‚       setShowSearchSuggestions(false);
 494 â”‚     }
 495 â”‚   };
 496 â”‚ 
 497 â”‚   // Open event details modal
 498 â”‚   const openEventDetails = (event: any) => {
 499 â”‚     setSelectedEvent(event);
 500 â”‚     setShowEventDetailsModal(true);
 501 â”‚   };
 502 â”‚ 
 503 â”‚   // Add new event
 504 â”‚   const handleAddEvent = async (newEvent: Omit<CalendarEvent, 'id'>) => {
 505 â”‚     try {
 506 â”‚       // O evento jÃ¡ foi salvo no banco de dados pelo modal
 507 â”‚       // Agora apenas atualizamos a interface
 508 â”‚       const updatedEvents = await getAllEvents();
 509 â”‚       setEvents(updatedEvents);
 510 â”‚     } catch (error) {
 511 â”‚       console.error("Erro ao atualizar lista de eventos:", error);
 512 â”‚     }
 513 â”‚   };
 514 â”‚ 
 515 â”‚   // Edit event
 516 â”‚   const handleEditEvent = (editedEvent: any) => {
 517 â”‚     const updatedEvents = { ...eventData };
 518 â”‚ 
 519 â”‚     // Find the event in all days and update it
 520 â”‚     let eventFound = false;
 521 â”‚ 
 522 â”‚     Object.keys(updatedEvents).forEach((day) => {
 523 â”‚       const dayNum = parseInt(day);
 524 â”‚       const eventIndex = updatedEvents[dayNum].findIndex(
 525 â”‚         (event) => event.id === editedEvent.id,
 526 â”‚       );
 527 â”‚ 
 528 â”‚       if (eventIndex !== -1) {
 529 â”‚         // Update the event in place
 530 â”‚         updatedEvents[dayNum][eventIndex] = {
 531 â”‚           ...editedEvent,
 532 â”‚           color: getEventColor(editedEvent.type),
 533 â”‚           time: editedEvent.startTime || editedEvent.time || "00:00",
 534 â”‚         };
 535 â”‚         eventFound = true;
 536 â”‚       }
 537 â”‚     });
 538 â”‚ 
 539 â”‚     // If the event wasn't found (rare case) or if the date changed
 540 â”‚     if (!eventFound && editedEvent.startDate) {
 541 â”‚       const newDay = new Date(editedEvent.startDate).getDate();
 542 â”‚       handleDeleteEvent(editedEvent.id);
 543 â”‚ 
 544 â”‚       // Add to the new day
 545 â”‚       const eventWithColor = {
 546 â”‚         ...editedEvent,
 547 â”‚         color: getEventColor(editedEvent.type),
 548 â”‚         time: editedEvent.startTime || "00:00",
 549 â”‚       };
 550 â”‚ 
 551 â”‚       if (updatedEvents[newDay]) {
 552 â”‚         updatedEvents[newDay] = [...updatedEvents[newDay], eventWithColor];
 553 â”‚       } else {
 554 â”‚         updatedEvents[newDay] = [eventWithColor];
 555 â”‚       }
 556 â”‚     }
 557 â”‚ 
 558 â”‚     setEventData(updatedEvents);
 559 â”‚ 
 560 â”‚     // Exibe uma mensagem de sucesso
 561 â”‚     toast({
 562 â”‚       title: "Evento atualizado",
 563 â”‚       description: "O evento foi atualizado com sucesso.",
 564 â”‚     });
 565 â”‚   };
 566 â”‚ 
 567 â”‚   // Delete event
 568 â”‚   const handleDeleteEvent = (eventId: string) => {
 569 â”‚     const updatedEvents = { ...eventData };
 570 â”‚ 
 571 â”‚     // Find and remove the event
 572 â”‚     Object.keys(updatedEvents).forEach((day) => {
 573 â”‚       const dayNum = parseInt(day);
 574 â”‚       updatedEvents[dayNum] = updatedEvents[dayNum].filter(
 575 â”‚         (event) => event.id !== eventId,
 576 â”‚       );
 577 â”‚ 
 578 â”‚       // Remove the day if it has no events
 579 â”‚       if (updatedEvents[dayNum].length === 0) {
 580 â”‚         delete updatedEvents[dayNum];
 581 â”‚       }
 582 â”‚     });
 583 â”‚ 
 584 â”‚     setEventData(updatedEvents);
 585 â”‚   };
 586 â”‚ 
 587 â”‚   // Handle event drag and drop
 588 â”‚   const handleEventDrop = (event: any, newDay: number) => {
 589 â”‚     // First, remove the event from its original day
 590 â”‚     const updatedEvents = { ...eventData };
 591 â”‚     let eventToMove = null;
 592 â”‚ 
 593 â”‚     // Find and remove the event from its original day
 594 â”‚     Object.keys(updatedEvents).forEach((day) => {
 595 â”‚       const dayNum = parseInt(day);
 596 â”‚       const eventIndex = updatedEvents[dayNum].findIndex(
 597 â”‚         (e) => e.id === event.id,
 598 â”‚       );
 599 â”‚ 
 600 â”‚       if (eventIndex !== -1) {
 601 â”‚         // Save the event before removing it
 602 â”‚         eventToMove = { ...updatedEvents[dayNum][eventIndex] };
 603 â”‚ 
 604 â”‚         // Remove the event from its original day
 605 â”‚         updatedEvents[dayNum] = updatedEvents[dayNum].filter(
 606 â”‚           (e) => e.id !== event.id,
 607 â”‚         );
 608 â”‚ 
 609 â”‚         // Remove the day if it has no events
 610 â”‚         if (updatedEvents[dayNum].length === 0) {
 611 â”‚           delete updatedEvents[dayNum];
 612 â”‚         }
 613 â”‚       }
 614 â”‚     });
 615 â”‚ 
 616 â”‚     // If we found the event, add it to the new day
 617 â”‚     if (eventToMove) {
 618 â”‚       // Update the event's date if it has one
 619 â”‚       if (eventToMove.startDate) {
 620 â”‚         const oldDate = new Date(eventToMove.startDate);
 621 â”‚         const newDate = new Date(oldDate);
 622 â”‚         newDate.setDate(newDay);
 623 â”‚         eventToMove.startDate = newDate;
 624 â”‚ 
 625 â”‚         // Also update endDate if it exists
 626 â”‚         if (eventToMove.endDate) {
 627 â”‚           const oldEndDate = new Date(eventToMove.endDate);
 628 â”‚           const dayDiff = Math.round(
 629 â”‚             (oldEndDate.getTime() - oldDate.getTime()) / (1000 * 60 * 60 * 24),
 630 â”‚           );
 631 â”‚           const newEndDate = new Date(newDate);
 632 â”‚           newEndDate.setDate(newDate.getDate() + dayDiff);
 633 â”‚           eventToMove.endDate = newEndDate;
 634 â”‚         }
 635 â”‚       }
 636 â”‚ 
 637 â”‚       // Add the event to the new day
 638 â”‚       if (updatedEvents[newDay]) {
 639 â”‚         updatedEvents[newDay] = [...updatedEvents[newDay], eventToMove];
 640 â”‚       } else {
 641 â”‚         updatedEvents[newDay] = [eventToMove];
 642 â”‚       }
 643 â”‚ 
 644 â”‚       setEventData(updatedEvents);
 645 â”‚     }
 646 â”‚   };
 647 â”‚ 
 648 â”‚   // Handle time range change
 649 â”‚   const handleTimeRangeChange = (range: string) => {
 650 â”‚     setTimeRange(range);
 651 â”‚   };
 652 â”‚ 
 653 â”‚   // Handle subject filter change
 654 â”‚   const handleSubjectChange = (e: React.ChangeEvent<HTMLSelectElement>) => {
 655 â”‚     setSelectedSubject(e.target.value);
 656 â”‚   };
 657 â”‚ 
 658 â”‚   // Handle add task
 659 â”‚   const handleAddTask = (newTask: any) => {
 660 â”‚     try {
 661 â”‚       if (!newTask || !newTask.title) {
 662 â”‚         console.error("Invalid task data", newTask);
 663 â”‚         return;
 664 â”‚       }
 665 â”‚ 
 666 â”‚       // First close modal to prevent UI freezing
 667 â”‚       setShowAddTaskModal(false);
 668 â”‚ 
 669 â”‚       setTimeout(() => {
 670 â”‚         // Format the task for the dashboard view
 671 â”‚         const formattedTask = {
 672 â”‚           id: newTask.id || `task-${Date.now()}`,
 673 â”‚           title: newTask.title,
 674 â”‚           discipline: newTask.discipline || "Geral",
 675 â”‚           dueDate: newTask.dueDate
 676 â”‚             ? `Vence ${new Date(newTask.dueDate).toLocaleDateString("pt-BR")}`
 677 â”‚             : "Sem data definida",
 678 â”‚           progress: newTask.progress || 0,
 679 â”‚           urgent: newTask.priority === "alta",
 680 â”‚           priority: newTask.priority || "mÃ©dia",
 681 â”‚         };
 682 â”‚ 
 683 â”‚         // Update the tasks list in the dashboard
 684 â”‚         setTasksData((prev) => [formattedTask, ...prev]);
 685 â”‚ 
 686 â”‚         // Show success message
 687 â”‚         toast({
 688 â”‚           title: "Tarefa adicionada",
 689 â”‚           description: "A nova tarefa foi adicionada com sucesso.",
 690 â”‚         });
 691 â”‚ 
 692 â”‚         // Refresh the tasks view
 693 â”‚         setTimeout(() => {
 694 â”‚           const tasksView = document.querySelector(
 695 â”‚             '[data-testid="tasks-view"]',
 696 â”‚           );
 697 â”‚           if (tasksView) {
 698 â”‚             const refreshEvent = new CustomEvent("refresh-tasks", {
 699 â”‚               detail: newTask,
 700 â”‚             });
 701 â”‚             tasksView.dispatchEvent(refreshEvent);
 702 â”‚           }
 703 â”‚         }, 200); // Small delay to ensure DOM is ready
 704 â”‚       }, 100);
 705 â”‚     } catch (error) {
 706 â”‚       console.error("Error adding task:", error);
 707 â”‚       toast({
 708 â”‚         title: "Erro ao adicionar tarefa",
 709 â”‚         description: "Ocorreu um erro ao adicionar a tarefa. Tente novamente.",
 710 â”‚         variant: "destructive",
 711 â”‚       });
 712 â”‚     }
 713 â”‚   };
 714 â”‚ 
 715 â”‚   // Calendar State
 716 â”‚   const [events, setEvents] = useState<CalendarEvent[]>([]);
 717 â”‚   const [selectedEvent, setSelectedEvent] = useState<CalendarEvent | null>(null);
     Â·          â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€
     Â·                â•°â”€â”€ `selectedEvent` redefined here
 718 â”‚ 
 719 â”‚   // Calendar View
 720 â”‚   const [view, setView] = useState<"month" | "week" | "day">("month");
     â•°â”€â”€â”€â”€

  Ã— the name `setSelectedEvent` is defined multiple times
     â•­â”€[/home/runner/workspace/src/pages/agenda/index.tsx:107:1]
 107 â”‚   const [showEpictusAIModal, setShowEpictusAIModal] = useState(false);
 108 â”‚   const [showEpictusCalendarModal, setShowEpictusCalendarModal] =
 109 â”‚     useState(false);
 110 â”‚   const [selectedEvent, setSelectedEvent] = useState<CalendarEvent | null>(null);
     Â·                         â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€
     Â·                                 â•°â”€â”€ previous definition of `setSelectedEvent` here
 111 â”‚   const [showSetGoalModal, setShowSetGoalModal] = useState(false);
 112 â”‚   const [showAddTaskModal, setShowAddTaskModal] = useState(false);
 113 â”‚   const [showAISuggestionsModal, setShowAISuggestionsModal] = useState(false);
 114 â”‚   const [tasksData, setTasksData] = useState([
 115 â”‚     {
 116 â”‚       id: "1",
 117 â”‚       title: "Lista de ExercÃ­cios - FunÃ§Ãµes TrigonomÃ©tricas",
 118 â”‚       discipline: "MatemÃ¡tica",
 119 â”‚       dueDate: "Vence hoje, 18:00",
 120 â”‚       progress: 75,
 121 â”‚       urgent: true,
 122 â”‚       priority: "alta",
 123 â”‚     },
 124 â”‚     {
 125 â”‚       id: "2",
 126 â”‚       title: "RelatÃ³rio de Experimento - TitulaÃ§Ã£o",
 127 â”‚       discipline: "QuÃ­mica",
 128 â”‚       dueDate: "Vence em 2 dias",
 129 â”‚       progress: 30,
 130 â”‚       urgent: false,
 131 â”‚       priority: "mÃ©dia",
 132 â”‚     },
 133 â”‚     {
 134 â”‚       id: "3",
 135 â”‚       title: "PreparaÃ§Ã£o para Prova - MecÃ¢nica QuÃ¢ntica",
 136 â”‚       discipline: "FÃ­sica",
 137 â”‚       dueDate: "Vence em 1 dia",
 138 â”‚       progress: 10,
 139 â”‚       urgent: true,
 140 â”‚       priority: "alta",
 141 â”‚     },
 142 â”‚   ]);
 143 â”‚ 
 144 â”‚   // Get current date for calendar
 145 â”‚   const currentDate = new Date();
 146 â”‚   const currentDay = currentDate.getDate();
 147 â”‚   const currentMonth = currentDate.getMonth();
 148 â”‚   const currentYear = currentDate.getFullYear();
 149 â”‚ 
 150 â”‚   // Update URL when active tab changes
 151 â”‚   useEffect(() => {
 152 â”‚     setSearchParams({ view: activeTab });
 153 â”‚   }, [activeTab, setSearchParams]);
 154 â”‚ 
 155 â”‚   // Update active tab when URL changes
 156 â”‚   useEffect(() => {
 157 â”‚     if (viewParam) {
 158 â”‚       setActiveTab(viewParam);
 159 â”‚     }
 160 â”‚   }, [viewParam]);
 161 â”‚ 
 162 â”‚   // Dados de eventos para o calendÃ¡rio (vazio por padrÃ£o)
 163 â”‚   const [eventData, setEventData] = useState<Record<number, any[]>>({});
 164 â”‚ 
 165 â”‚   // FunÃ§Ã£o para formatar eventos prÃ³ximos a partir do eventData
 166 â”‚   const getUpcomingEvents = () => {
 167 â”‚     const today = new Date();
 168 â”‚     today.setHours(0, 0, 0, 0); // Normaliza a data atual para comparaÃ§Ã£o
 169 â”‚     const upcoming: any[] = [];
 170 â”‚ 
 171 â”‚     // Percorre todos os dias com eventos
 172 â”‚     Object.keys(eventData).forEach(day => {
 173 â”‚       const dayEvents = eventData[parseInt(day)] || [];
 174 â”‚ 
 175 â”‚       // Para cada evento nesse dia
 176 â”‚       dayEvents.forEach(event => {
 177 â”‚         if (event.startDate) {
 178 â”‚           const eventDate = new Date(event.startDate);
 179 â”‚           eventDate.setHours(0, 0, 0, 0); // Normaliza a data do evento para comparaÃ§Ã£o
 180 â”‚ 
 181 â”‚           // Adiciona eventos que ocorrem hoje ou no futuro
 182 â”‚           if (eventDate >= today) {
 183 â”‚             // Formata a data com date-fns
 184 â”‚             const formattedDate = format(eventDate, "dd/MM/yyyy", { locale: ptBR });
 185 â”‚ 
 186 â”‚             upcoming.push({
 187 â”‚               id: event.id,
 188 â”‚               type: event.type,
 189 â”‚               title: event.title,
 190 â”‚               day: formattedDate,
 191 â”‚               discipline: event.discipline || "Geral",
 192 â”‚               isOnline: event.isOnline || false,
 193 â”‚               color: event.color,
 194 â”‚               details: event.details,
 195 â”‚               startTime: event.startTime || event.time || "00:00",
 196 â”‚               // Guardar a data original para ordenaÃ§Ã£o
 197 â”‚               originalDate: eventDate,
 198 â”‚               originalTime: event.startTime || event.time || "00:00"
 199 â”‚             });
 200 â”‚           }
 201 â”‚         }
 202 â”‚       });
 203 â”‚     });
 204 â”‚ 
 205 â”‚     // Ordena eventos cronologicamente (por data e hora)
 206 â”‚     upcoming.sort((a, b) => {
 207 â”‚       // Primeiro compara por data
 208 â”‚       const dateComparison = a.originalDate.getTime() - b.originalDate.getTime();
 209 â”‚ 
 210 â”‚       // Se for a mesma data, compara pelo horÃ¡rio
 211 â”‚       if (dateComparison === 0) {
 212 â”‚         const [hoursA, minutesA] = a.originalTime.split(':').map(Number);
 213 â”‚         const [hoursB, minutesB] = b.originalTime.split(':').map(Number);
 214 â”‚ 
 215 â”‚         // Compara horas
 216 â”‚         if (hoursA !== hoursB) {
 217 â”‚           return hoursA - hoursB;
 218 â”‚         }
 219 â”‚ 
 220 â”‚         // Se as horas forem iguais, compara minutos
 221 â”‚         return minutesA - minutesB;
 222 â”‚       }
 223 â”‚ 
 224 â”‚       return dateComparison;
 225 â”‚     });
 226 â”‚ 
 227 â”‚     return upcoming;
 228 â”‚   };
 229 â”‚ 
 230 â”‚   // Array de eventos prÃ³ximos atualizado a partir do eventData
 231 â”‚   const upcomingEventsData = getUpcomingEvents();
 232 â”‚ 
 233 â”‚   // Sample AI recommendations
 234 â”‚   const aiRecommendations = [
 235 â”‚     {
 236 â”‚       id: "1",
 237 â”‚       priority: "high",
 238 â”‚       title: "Prioridade Alta: VocÃª tem uma prova de FÃ­sica amanhÃ£",
 239 â”‚       description:
 240 â”‚         "Recomendo revisar os conceitos de MecÃ¢nica QuÃ¢ntica hoje Ã  noite.",
 241 â”‚       actions: [
 242 â”‚         {
 243 â”‚           label: "Ver Material",
 244 â”‚           icon: <FileText className="h-3.5 w-3.5 mr-1" />,
 245 â”‚           variant: "outline",
 246 â”‚         },
 247 â”‚         {
 248 â”‚           label: "Criar Resumo",
 249 â”‚           icon: <FileEdit className="h-3.5 w-3.5 mr-1" />,
 250 â”‚           variant: "default",
 251 â”‚         },
 252 â”‚       ],
 253 â”‚       icon: <AlertCircle className="h-5 w-5 text-red-500" />,
 254 â”‚     },
 255 â”‚     {
 256 â”‚       id: "2",
 257 â”‚       priority: "medium",
 258 â”‚       title: "Seu desempenho em QuÃ­mica caiu 15% na Ãºltima semana",
 259 â”‚       description: "Que tal revisar os conceitos de titulaÃ§Ã£o?",
 260 â”‚       actions: [
 261 â”‚         {
 262 â”‚           label: "Ver Desempenho",
 263 â”‚           icon: <LineChart className="h-3.5 w-3.5 mr-1" />,
 264 â”‚           variant: "outline",
 265 â”‚         },
 266 â”‚         {
 267 â”‚           label: "Praticar ExercÃ­cios",
 268 â”‚           icon: <CheckSquare className="h-3.5 w-3.5 mr-1" />,
 269 â”‚           variant: "default",
 270 â”‚         },
 271 â”‚       ],
 272 â”‚       icon: <Flame className="h-5 w-5 text-amber-500" />,
 273 â”‚     },
 274 â”‚     {
 275 â”‚       id: "3",
 276 â”‚       priority: "low",
 277 â”‚       title: "VocÃª estÃ¡ com uma sequÃªncia de 7 dias de estudo!",
 278 â”‚       description: "Continue assim para ganhar mais pontos de experiÃªncia.",
 279 â”‚       actions: [
 280 â”‚         {
 281 â”‚           label: "Ver Conquistas",
 282 â”‚           icon: <Trophy className="h-3.5 w-3.5 mr-1" />,
 283 â”‚           variant: "outline",
 284 â”‚         },
 285 â”‚       ],
 286 â”‚       icon: <Zap className="h-5 w-5 text-green-500" />,
 287 â”‚     },
 288 â”‚   ];
 289 â”‚ 
 290 â”‚   // Sample study time data
 291 â”‚   const studyTimeData = {
 292 â”‚     total: 32,
 293 â”‚     goal: 40,
 294 â”‚     progress: 80, // 32/40 = 80%
 295 â”‚     byDay: [
 296 â”‚       { day: "Seg", hours: 5 },
 297 â”‚       { day: "Ter", hours: 6 },
 298 â”‚       { day: "Qua", hours: 4 },
 299 â”‚       { day: "Qui", hours: 7 },
 300 â”‚       { day: "Sex", hours: 5 },
 301 â”‚       { day: "SÃ¡b", hours: 3 },
 302 â”‚       { day: "Dom", hours: 2 },
 303 â”‚     ],
 304 â”‚     bySubject: [
 305 â”‚       { subject: "MatemÃ¡tica", hours: 10, color: "#FF6B00" },
 306 â”‚       { subject: "FÃ­sica", hours: 8, color: "#FF8C40" },
 307 â”‚       { subject: "QuÃ­mica", hours: 6, color: "#E85D04" },
 308 â”‚       { subject: "Biologia", hours: 5, color: "#DC2F02" },
 309 â”‚       { subject: "HistÃ³ria", hours: 3, color: "#9D0208" },
 310 â”‚     ],
 311 â”‚   };
 312 â”‚ 
 313 â”‚   // Sample last accessed classes
 314 â”‚   const lastAccessedClasses = [
 315 â”‚     {
 316 â”‚       id: "1",
 317 â”‚       title: "FunÃ§Ãµes TrigonomÃ©tricas",
 318 â”‚       discipline: "MatemÃ¡tica",
 319 â”‚       professor: "Prof. Carlos Santos",
 320 â”‚       progress: 75,
 321 â”‚       thumbnail:
 322 â”‚         "https://images.unsplash.com/photo-1635070041078-e363dbe005cb?w=300&q=80",
 323 â”‚       lastAccessed: "Hoje, 10:30",
 324 â”‚     },
 325 â”‚     {
 326 â”‚       id: "2",
 327 â”‚       title: "MecÃ¢nica QuÃ¢ntica - IntroduÃ§Ã£o",
 328 â”‚       discipline: "FÃ­sica",
 329 â”‚       professor: "Prof. Roberto Alves",
 330 â”‚       progress: 45,
 331 â”‚       thumbnail:
 332 â”‚         "https://images.unsplash.com/photo-1636466497217-26a8cbeaf0aa?w=300&q=80",
 333 â”‚       lastAccessed: "Ontem, 15:20",
 334 â”‚     },
 335 â”‚     {
 336 â”‚       id: "3",
 337 â”‚       title: "TitulaÃ§Ã£o e pH",
 338 â”‚       discipline: "QuÃ­mica",
 339 â”‚       professor: "Profa. Ana Martins",
 340 â”‚       progress: 90,
 341 â”‚       thumbnail:
 342 â”‚         "https://images.unsplash.com/photo-1603126857599-f6e157fa2fe6?w=300&q=80",
 343 â”‚       lastAccessed: "2 dias atrÃ¡s, 14:15",
 344 â”‚     },
 345 â”‚   ];
 346 â”‚ 
 347 â”‚   // Sample ranking data
 348 â”‚   const rankingData = {
 349 â”‚     position: 42,
 350 â”‚     total: 210,
 351 â”‚     points: 3750,
 352 â”‚     nextReward: 4000,
 353 â”‚     progress: 75, // (3750/4000)*100 = 93.75%
 354 â”‚     trend: "+5", // Subiu 5 posiÃ§Ãµes
 355 â”‚   };
 356 â”‚ 
 357 â”‚   // Sample subject progress data
 358 â”‚   const subjectProgressData = [
 359 â”‚     { subject: "MatemÃ¡tica", progress: 85, goal: 90, color: "#FF6B00" },
 360 â”‚     { subject: "FÃ­sica", progress: 72, goal: 80, color: "#FF8C40" },
 361 â”‚     { subject: "QuÃ­mica", progress: 65, goal: 75, color: "#E85D04" },
 362 â”‚     { subject: "Biologia", progress: 90, goal: 85, color: "#DC2F02" },
 363 â”‚     { subject: "HistÃ³ria", progress: 78, goal: 80, color: "#9D0208" },
 364 â”‚   ];
 365 â”‚ 
 366 â”‚   // Sample today's events data
 367 â”‚   const todayEventsData = [
 368 â”‚     {
 369 â”‚       id: "1",
 370 â”‚       type: "aula",
 371 â”‚       title: "Aula de MatemÃ¡tica",
 372 â”‚       time: "10:00 - 11:30",
 373 â”‚       status: "agora",
 374 â”‚       discipline: "MatemÃ¡tica",
 375 â”‚       isOnline: true,
 376 â”‚     },
 377 â”‚     {
 378 â”‚       id: "2",
 379 â”‚       type: "trabalho",
 380 â”‚       title: "Entrega de Trabalho",
 381 â”‚       time: "atÃ© 18:00",
 382 â”‚       status: "pendente",
 383 â”‚       discipline: "QuÃ­mica",
 384 â”‚       isOnline: true,
 385 â”‚     },
 386 â”‚   ];
 387 â”‚ 
 388 â”‚   // Get event icon based on type
 389 â”‚   const getEventIcon = (type: string) => {
 390 â”‚     switch (type) {
 391 â”‚       case "aula":
 392 â”‚         return <Video className="h-4 w-4" />;
 393 â”‚       case "trabalho":
 394 â”‚         return <FileEdit className="h-4 w-4" />;
 395 â”‚       case "prova":
 396 â”‚         return <AlertCircle className="h-4 w-4" />;
 397 â”‚       case "reuniao":
 398 â”‚         return <Users className="h-4 w-4" />;
 399 â”‚       case "lembrete":
 400 â”‚         return <Bell className="h-4 w-4" />;
 401 â”‚       case "tarefa":
 402 â”‚         return <CheckSquare className="h-4 w-4" />;
 403 â”‚       default:
 404 â”‚         return <CalendarIcon className="h-4 w-4" />;
 405 â”‚     }
 406 â”‚   };
 407 â”‚ 
 408 â”‚   // Get event color based on type
 409 â”‚   const getEventColor = (type: string) => {
 410 â”‚     switch (type) {
 411 â”‚       case "aula":
 412 â”‚         return "blue";
 413 â”‚       case "trabalho":
 414 â”‚       case "tarefa":
 415 â”‚         return "amber";
 416 â”‚       case "prova":
 417 â”‚         return "red";
 418 â”‚       case "reuniao":
 419 â”‚         return "green";
 420 â”‚       case "lembrete":
 421 â”‚         return "yellow";
 422 â”‚       case "evento":
 423 â”‚         return "purple";
 424 â”‚       default:
 425 â”‚         return "gray";
 426 â”‚     }
 427 â”‚   };
 428 â”‚ 
 429 â”‚   // Get task icon based on type
 430 â”‚   const getTaskIcon = (discipline: string) => {
 431 â”‚     switch (discipline) {
 432 â”‚       case "MatemÃ¡tica":
 433 â”‚         return <span className="text-[#FF6B00] font-bold">Ï€</span>;
 434 â”‚       case "FÃ­sica":
 435 â”‚         return <span className="text-[#FF8C40] font-bold">âš›</span>;
 436 â”‚       case "QuÃ­mica":
 437 â”‚         return <span className="text-[#E85D04] font-bold">âš—</span>;
 438 â”‚       case "Biologia":
 439 â”‚         return <span className="text-[#DC2F02] font-bold">ðŸ§¬</span>;
 440 â”‚       case "HistÃ³ria":
 441 â”‚         return <span className="text-[#9D0208] font-bold">ðŸ“œ</span>;
 442 â”‚       default:
 443 â”‚         return <BookOpen className="h-4 w-4" />;
 444 â”‚     }
 445 â”‚   };
 446 â”‚ 
 447 â”‚   // Get priority badge color
 448 â”‚   const getPriorityColor = (priority: string) => {
 449 â”‚     switch (priority) {
 450 â”‚       case "alta":
 451 â”‚         return "bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";
 452 â”‚       case "mÃ©dia":
 453 â”‚         return "bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-300";
 454 â”‚       case "baixa":
 455 â”‚         return "bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";
 456 â”‚       default:
 457 â”‚         return "bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300";
 458 â”‚     }
 459 â”‚   };
 460 â”‚ 
 461 â”‚   // Get status badge color
 462 â”‚   const getStatusBadge = (status: string) => {
 463 â”‚     switch (status) {
 464 â”‚       case "agora":
 465 â”‚         return <Badge className="bg-green-500 text-white">Agora</Badge>;
 466 â”‚       case "pendente":
 467 â”‚         return <Badge className="bg-amber-500 text-white">Pendente</Badge>;
 468 â”‚       default:
 469 â”‚         return null;
 470 â”‚     }
 471 â”‚   };
 472 â”‚ 
 473 â”‚   // Handle search input
 474 â”‚   const handleSearchInput = (e: React.ChangeEvent<HTMLInputElement>) => {
 475 â”‚     const query = e.target.value;
 476 â”‚     setSearchQuery(query);
 477 â”‚ 
 478 â”‚     if (query.length > 2) {
 479 â”‚       // Simulate search suggestions
 480 â”‚       const suggestions = [
 481 â”‚         "Aula de MatemÃ¡tica",
 482 â”‚         "Prova de FÃ­sica",
 483 â”‚         "Grupo de Estudos",
 484 â”‚         "Entrega de Trabalho",
 485 â”‚         "MatemÃ¡tica",
 486 â”‚         "FÃ­sica",
 487 â”‚         "Prof. Carlos Santos",
 488 â”‚       ].filter((item) => item.toLowerCase().includes(query.toLowerCase()));
 489 â”‚ 
 490 â”‚       setSearchSuggestions(suggestions);
 491 â”‚       setShowSearchSuggestions(suggestions.length > 0);
 492 â”‚     } else {
 493 â”‚       setShowSearchSuggestions(false);
 494 â”‚     }
 495 â”‚   };
 496 â”‚ 
 497 â”‚   // Open event details modal
 498 â”‚   const openEventDetails = (event: any) => {
 499 â”‚     setSelectedEvent(event);
 500 â”‚     setShowEventDetailsModal(true);
 501 â”‚   };
 502 â”‚ 
 503 â”‚   // Add new event
 504 â”‚   const handleAddEvent = async (newEvent: Omit<CalendarEvent, 'id'>) => {
 505 â”‚     try {
 506 â”‚       // O evento jÃ¡ foi salvo no banco de dados pelo modal
 507 â”‚       // Agora apenas atualizamos a interface
 508 â”‚       const updatedEvents = await getAllEvents();
 509 â”‚       setEvents(updatedEvents);
 510 â”‚     } catch (error) {
 511 â”‚       console.error("Erro ao atualizar lista de eventos:", error);
 512 â”‚     }
 513 â”‚   };
 514 â”‚ 
 515 â”‚   // Edit event
 516 â”‚   const handleEditEvent = (editedEvent: any) => {
 517 â”‚     const updatedEvents = { ...eventData };
 518 â”‚ 
 519 â”‚     // Find the event in all days and update it
 520 â”‚     let eventFound = false;
 521 â”‚ 
 522 â”‚     Object.keys(updatedEvents).forEach((day) => {
 523 â”‚       const dayNum = parseInt(day);
 524 â”‚       const eventIndex = updatedEvents[dayNum].findIndex(
 525 â”‚         (event) => event.id === editedEvent.id,
 526 â”‚       );
 527 â”‚ 
 528 â”‚       if (eventIndex !== -1) {
 529 â”‚         // Update the event in place
 530 â”‚         updatedEvents[dayNum][eventIndex] = {
 531 â”‚           ...editedEvent,
 532 â”‚           color: getEventColor(editedEvent.type),
 533 â”‚           time: editedEvent.startTime || editedEvent.time || "00:00",
 534 â”‚         };
 535 â”‚         eventFound = true;
 536 â”‚       }
 537 â”‚     });
 538 â”‚ 
 539 â”‚     // If the event wasn't found (rare case) or if the date changed
 540 â”‚     if (!eventFound && editedEvent.startDate) {
 541 â”‚       const newDay = new Date(editedEvent.startDate).getDate();
 542 â”‚       handleDeleteEvent(editedEvent.id);
 543 â”‚ 
 544 â”‚       // Add to the new day
 545 â”‚       const eventWithColor = {
 546 â”‚         ...editedEvent,
 547 â”‚         color: getEventColor(editedEvent.type),
 548 â”‚         time: editedEvent.startTime || "00:00",
 549 â”‚       };
 550 â”‚ 
 551 â”‚       if (updatedEvents[newDay]) {
 552 â”‚         updatedEvents[newDay] = [...updatedEvents[newDay], eventWithColor];
 553 â”‚       } else {
 554 â”‚         updatedEvents[newDay] = [eventWithColor];
 555 â”‚       }
 556 â”‚     }
 557 â”‚ 
 558 â”‚     setEventData(updatedEvents);
 559 â”‚ 
 560 â”‚     // Exibe uma mensagem de sucesso
 561 â”‚     toast({
 562 â”‚       title: "Evento atualizado",
 563 â”‚       description: "O evento foi atualizado com sucesso.",
 564 â”‚     });
 565 â”‚   };
 566 â”‚ 
 567 â”‚   // Delete event
 568 â”‚   const handleDeleteEvent = (eventId: string) => {
 569 â”‚     const updatedEvents = { ...eventData };
 570 â”‚ 
 571 â”‚     // Find and remove the event
 572 â”‚     Object.keys(updatedEvents).forEach((day) => {
 573 â”‚       const dayNum = parseInt(day);
 574 â”‚       updatedEvents[dayNum] = updatedEvents[dayNum].filter(
 575 â”‚         (event) => event.id !== eventId,
 576 â”‚       );
 577 â”‚ 
 578 â”‚       // Remove the day if it has no events
 579 â”‚       if (updatedEvents[dayNum].length === 0) {
 580 â”‚         delete updatedEvents[dayNum];
 581 â”‚       }
 582 â”‚     });
 583 â”‚ 
 584 â”‚     setEventData(updatedEvents);
 585 â”‚   };
 586 â”‚ 
 587 â”‚   // Handle event drag and drop
 588 â”‚   const handleEventDrop = (event: any, newDay: number) => {
 589 â”‚     // First, remove the event from its original day
 590 â”‚     const updatedEvents = { ...eventData };
 591 â”‚     let eventToMove = null;
 592 â”‚ 
 593 â”‚     // Find and remove the event from its original day
 594 â”‚     Object.keys(updatedEvents).forEach((day) => {
 595 â”‚       const dayNum = parseInt(day);
 596 â”‚       const eventIndex = updatedEvents[dayNum].findIndex(
 597 â”‚         (e) => e.id === event.id,
 598 â”‚       );
 599 â”‚ 
 600 â”‚       if (eventIndex !== -1) {
 601 â”‚         // Save the event before removing it
 602 â”‚         eventToMove = { ...updatedEvents[dayNum][eventIndex] };
 603 â”‚ 
 604 â”‚         // Remove the event from its original day
 605 â”‚         updatedEvents[dayNum] = updatedEvents[dayNum].filter(
 606 â”‚           (e) => e.id !== event.id,
 607 â”‚         );
 608 â”‚ 
 609 â”‚         // Remove the day if it has no events
 610 â”‚         if (updatedEvents[dayNum].length === 0) {
 611 â”‚           delete updatedEvents[dayNum];
 612 â”‚         }
 613 â”‚       }
 614 â”‚     });
 615 â”‚ 
 616 â”‚     // If we found the event, add it to the new day
 617 â”‚     if (eventToMove) {
 618 â”‚       // Update the event's date if it has one
 619 â”‚       if (eventToMove.startDate) {
 620 â”‚         const oldDate = new Date(eventToMove.startDate);
 621 â”‚         const newDate = new Date(oldDate);
 622 â”‚         newDate.setDate(newDay);
 623 â”‚         eventToMove.startDate = newDate;
 624 â”‚ 
 625 â”‚         // Also update endDate if it exists
 626 â”‚         if (eventToMove.endDate) {
 627 â”‚           const oldEndDate = new Date(eventToMove.endDate);
 628 â”‚           const dayDiff = Math.round(
 629 â”‚             (oldEndDate.getTime() - oldDate.getTime()) / (1000 * 60 * 60 * 24),
 630 â”‚           );
 631 â”‚           const newEndDate = new Date(newDate);
 632 â”‚           newEndDate.setDate(newDate.getDate() + dayDiff);
 633 â”‚           eventToMove.endDate = newEndDate;
 634 â”‚         }
 635 â”‚       }
 636 â”‚ 
 637 â”‚       // Add the event to the new day
 638 â”‚       if (updatedEvents[newDay]) {
 639 â”‚         updatedEvents[newDay] = [...updatedEvents[newDay], eventToMove];
 640 â”‚       } else {
 641 â”‚         updatedEvents[newDay] = [eventToMove];
 642 â”‚       }
 643 â”‚ 
 644 â”‚       setEventData(updatedEvents);
 645 â”‚     }
 646 â”‚   };
 647 â”‚ 
 648 â”‚   // Handle time range change
 649 â”‚   const handleTimeRangeChange = (range: string) => {
 650 â”‚     setTimeRange(range);
 651 â”‚   };
 652 â”‚ 
 653 â”‚   // Handle subject filter change
 654 â”‚   const handleSubjectChange = (e: React.ChangeEvent<HTMLSelectElement>) => {
 655 â”‚     setSelectedSubject(e.target.value);
 656 â”‚   };
 657 â”‚ 
 658 â”‚   // Handle add task
 659 â”‚   const handleAddTask = (newTask: any) => {
 660 â”‚     try {
 661 â”‚       if (!newTask || !newTask.title) {
 662 â”‚         console.error("Invalid task data", newTask);
 663 â”‚         return;
 664 â”‚       }
 665 â”‚ 
 666 â”‚       // First close modal to prevent UI freezing
 667 â”‚       setShowAddTaskModal(false);
 668 â”‚ 
 669 â”‚       setTimeout(() => {
 670 â”‚         // Format the task for the dashboard view
 671 â”‚         const formattedTask = {
 672 â”‚           id: newTask.id || `task-${Date.now()}`,
 673 â”‚           title: newTask.title,
 674 â”‚           discipline: newTask.discipline || "Geral",
 675 â”‚           dueDate: newTask.dueDate
 676 â”‚             ? `Vence ${new Date(newTask.dueDate).toLocaleDateString("pt-BR")}`
 677 â”‚             : "Sem data definida",
 678 â”‚           progress: newTask.progress || 0,
 679 â”‚           urgent: newTask.priority === "alta",
 680 â”‚           priority: newTask.priority || "mÃ©dia",
 681 â”‚         };
 682 â”‚ 
 683 â”‚         // Update the tasks list in the dashboard
 684 â”‚         setTasksData((prev) => [formattedTask, ...prev]);
 685 â”‚ 
 686 â”‚         // Show success message
 687 â”‚         toast({
 688 â”‚           title: "Tarefa adicionada",
 689 â”‚           description: "A nova tarefa foi adicionada com sucesso.",
 690 â”‚         });
 691 â”‚ 
 692 â”‚         // Refresh the tasks view
 693 â”‚         setTimeout(() => {
 694 â”‚           const tasksView = document.querySelector(
 695 â”‚             '[data-testid="tasks-view"]',
 696 â”‚           );
 697 â”‚           if (tasksView) {
 698 â”‚             const refreshEvent = new CustomEvent("refresh-tasks", {
 699 â”‚               detail: newTask,
 700 â”‚             });
 701 â”‚             tasksView.dispatchEvent(refreshEvent);
 702 â”‚           }
 703 â”‚         }, 200); // Small delay to ensure DOM is ready
 704 â”‚       }, 100);
 705 â”‚     } catch (error) {
 706 â”‚       console.error("Error adding task:", error);
 707 â”‚       toast({
 708 â”‚         title: "Erro ao adicionar tarefa",
 709 â”‚         description: "Ocorreu um erro ao adicionar a tarefa. Tente novamente.",
 710 â”‚         variant: "destructive",
 711 â”‚       });
 712 â”‚     }
 713 â”‚   };
 714 â”‚ 
 715 â”‚   // Calendar State
 716 â”‚   const [events, setEvents] = useState<CalendarEvent[]>([]);
 717 â”‚   const [selectedEvent, setSelectedEvent] = useState<CalendarEvent | null>(null);
     Â·                         â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€
     Â·                                 â•°â”€â”€ `setSelectedEvent` redefined here
 718 â”‚ 
 719 â”‚   // Calendar View
 720 â”‚   const [view, setView] = useState<"month" | "week" | "day">("month");
     â•°â”€â”€â”€â”€
/home/runner/workspace/src/pages/agenda/index.tsx:107:1
988|                        <MonthView
989|                          eventData={eventData}
990|                          selectedDay={selectedDay}
   |                                     ^
991|                          setSelectedDay={setSelectedDay}
992|                          onEventClick={openEventDetails}