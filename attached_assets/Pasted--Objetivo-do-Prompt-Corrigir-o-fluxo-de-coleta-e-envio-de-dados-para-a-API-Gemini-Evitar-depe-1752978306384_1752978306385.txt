ğŸ¯ Objetivo do Prompt
âœ… Corrigir o fluxo de coleta e envio de dados para a API Gemini.
âœ… Evitar dependÃªncia de LocalStorage temporÃ¡rio para coleta dos dados no momento de envio.
âœ… Garantir que os dados fluam diretamente do estado para a API no momento certo.
âœ… Validar e filtrar atividades geradas pela Gemini apenas com as permitidas em schoolPowerActivities.json.
âœ… Renderizar mini-cards checkbox personalizados com tÃ­tulos reais e coerentes no ActionPlanCard.
âœ… Garantir logs claros em cada etapa para facilitar rastreamento de falhas.
âœ… Manter o cÃ³digo limpo, modular e escalÃ¡vel.

ğŸ› ï¸ Tarefas a serem executadas:
1ï¸âƒ£ Corrigir fluxo de coleta e envio de dados:
No useSchoolPowerFlow.ts, substituir dependÃªncias de LocalStorage ou qualquer cache temporÃ¡rio por uso centralizado de Zustand ou Context API.

Garantir que ao enviar o ChatInput, os dados sejam salvos imediatamente no store schoolPowerStore.message.

Garantir que ao submeter o ContextualizationCard, os dados sejam salvos em schoolPowerStore.contextualizationData.

Imediatamente apÃ³s a submissÃ£o do ContextualizationCard, disparar a funÃ§Ã£o generatePersonalizedPlan, que irÃ¡:

Coletar schoolPowerStore.message.

Coletar schoolPowerStore.contextualizationData.

Consultar schoolPowerActivities.json com as 137 atividades disponÃ­veis.

2ï¸âƒ£ Corrigir o arquivo generatePersonalizedPlan.ts:
Construir o prompt enviado para a API Gemini de forma clara, enviando:

json
Copiar
Editar
{
  "userMessage": "{conteÃºdo salvo em schoolPowerStore.message}",
  "quizResponses": { ...schoolPowerStore.contextualizationData },
  "availableActivities": [{ todas as 137 atividades do JSON }]
}
Utilizar a API Key AIzaSyD-Sso0SdyYKoA4M3tQhcWjQ1AoddB7Wo4 corretamente.

Implementar tratamento de erro e fallback em caso de falha de resposta.

3ï¸âƒ£ Corrigir o arquivo validateGeminiPlan.ts:
Validar cada id retornado pela API Gemini, conferindo se existe em schoolPowerActivities.json.

Se nÃ£o existir, remover do array antes de renderizar no ActionPlanCard.

Retornar apenas as atividades vÃ¡lidas, no formato:

json
Copiar
Editar
[
  {
    "id": "prova-interativa",
    "title": "Prova de MatemÃ¡tica - 28/07 - 3Âº Ano",
    "description": "AvaliaÃ§Ã£o focada nos conteÃºdos de geometria e Ã¡lgebra para o 3Âº ano."
  }
]
4ï¸âƒ£ Corrigir renderizaÃ§Ã£o no ActionPlanCard.tsx:
O componente deve receber as atividades validadas e personalizadas como props.

Renderizar mini-cards checkbox dinamicamente com tÃ­tulo e descriÃ§Ã£o personalizados.

Manter o contador de atividades selecionadas dinÃ¢mico.

Habilitar o botÃ£o â€œAprovar Planoâ€ apenas quando ao menos 1 atividade for selecionada.

Usar animaÃ§Ã£o suave com Framer Motion na transiÃ§Ã£o de ContextualizationCard -> ActionPlanCard.

5ï¸âƒ£ Logging e rastreamento:
Adicionar logs claros em cada etapa:
âœ… Envio do ChatInput.
âœ… SubmissÃ£o do ContextualizationCard.
âœ… Chamada para a API Gemini.
âœ… Resposta da API Gemini.
âœ… ValidaÃ§Ã£o das atividades.
âœ… RenderizaÃ§Ã£o no ActionPlanCard.

6ï¸âƒ£ Remover LocalStorage ou Sincronizar se realmente necessÃ¡rio:
Se o LocalStorage for utilizado, garantir:
âœ… Dados atualizados imediatamente apÃ³s envio.
âœ… SincronizaÃ§Ã£o entre LocalStorage e Zustand para evitar valores defasados.

Recomendado: utilizar Zustand ou Context puro para evitar inconsistÃªncias.

ğŸ“‹ Resumo TÃ©cnico para a IA Programadora:
âœ… Revisar useSchoolPowerFlow.ts e garantir coleta e passagem correta dos dados em tempo real.
âœ… Garantir chamada estruturada e correta Ã  API Gemini utilizando todos os dados coletados.
âœ… Validar a resposta da Gemini com as atividades disponÃ­veis em schoolPowerActivities.json.
âœ… Renderizar corretamente no ActionPlanCard com tÃ­tulos personalizados e coerentes.
âœ… Garantir rastreabilidade com logs.
âœ… Evitar dependÃªncias de dados defasados por cache/LocalStorage.

âš¡ Exemplo de prompt a ser enviado para a API Gemini dentro de generatePersonalizedPlan.ts:
javascript
Copiar
Editar
VocÃª Ã© a IA do School Power. Gere entre 3 e 5 atividades personalizadas, utilizando SOMENTE as atividades disponÃ­veis abaixo.

Mensagem inicial:
"{mensagem do usuÃ¡rio}"

Respostas do Quiz:
- MatÃ©rias e temas: "{materias}"
- PÃºblico-alvo: "{publico_alvo}"
- RestriÃ§Ãµes ou preferÃªncias: "{restricoes}"
- Datas importantes: "{datas}"
- ObservaÃ§Ãµes: "{observacoes}"

Atividades disponÃ­veis:
[{todas as 137 atividades do JSON}]

Retorne em JSON:
[
  {
    "id": "id_existente",
    "title": "TÃ­tulo personalizado com base nos dados",
    "description": "DescriÃ§Ã£o personalizada com base nos dados"
  },
  ...
]
âœ… Entrega esperada
ğŸ”¹ Sistema do School Power 100% funcional:
âœ… Dados reais coletados e enviados corretamente.
âœ… Consultando a Gemini com os dados reais e as atividades disponÃ­veis.
âœ… Renderizando atividades personalizadas reais no card de Plano de AÃ§Ã£o.
âœ… Sem automatismos engessados.
âœ… Com rastreabilidade e clareza de logs.

