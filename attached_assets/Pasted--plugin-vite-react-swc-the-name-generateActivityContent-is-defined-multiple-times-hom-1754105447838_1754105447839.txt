[plugin:vite:react-swc] Ã— the name `generateActivityContent` is defined multiple times
     â•­â”€[/home/runner/workspace/src/features/schoolpower/construction/api/generateActivity.ts:195:1]
 195 â”‚ 
 196 â”‚ export { buildActivityPrompt, parseActivityResponse };
 197 â”‚ 
 198 â”‚ export const generateActivityContent = async (
     Â·              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Â·                         â•°â”€â”€ previous definition of `generateActivityContent` here
 199 â”‚   activityType: string,
 200 â”‚   contextData: any
 201 â”‚ ): Promise<any> => {
 202 â”‚   try {
 203 â”‚     console.log('ğŸ¤– Iniciando geraÃ§Ã£o de conteÃºdo com Gemini para:', activityType);
 204 â”‚     console.log('ğŸ“‹ Dados de contexto completos:', JSON.stringify(contextData, null, 2));
 205 â”‚ 
 206 â”‚     const geminiClient = new GeminiClient();
 207 â”‚ 
 208 â”‚     // Prompt especÃ­fico para Lista de ExercÃ­cios
 209 â”‚     let prompt = '';
 210 â”‚ 
 211 â”‚     if (activityType === 'lista-exercicios') {
 212 â”‚       // Importar o prompt especÃ­fico
 213 â”‚       const { buildListaExerciciosPrompt } = await import('../../prompts/listaExerciciosPrompt');
 214 â”‚       prompt = buildListaExerciciosPrompt(contextData);
 215 â”‚       console.log('ğŸ“ Prompt gerado para lista de exercÃ­cios:', prompt.substring(0, 500) + '...');
 216 â”‚     } else {
 217 â”‚       // Prompt genÃ©rico para outros tipos de atividade
 218 â”‚       prompt = `
 219 â”‚ Crie o conteÃºdo educacional para uma atividade do tipo "${activityType}" com base no seguinte contexto:
 220 â”‚ 
 221 â”‚ CONTEXTO:
 222 â”‚ ${JSON.stringify(contextData, null, 2)}
 223 â”‚ 
 224 â”‚ FORMATO: Responda em JSON estruturado com todos os campos relevantes para o tipo de atividade solicitado.
 225 â”‚ REQUISITOS: ConteÃºdo educativo, bem estruturado e adequado ao contexto fornecido.
 226 â”‚ 
 227 â”‚ Responda APENAS com o JSON, sem texto adicional.`;
 228 â”‚     }
 229 â”‚ 
 230 â”‚     console.log('ğŸ“¤ Enviando prompt para Gemini...');
 231 â”‚ 
 232 â”‚     const response = await geminiClient.generate({
 233 â”‚       prompt,
 234 â”‚       temperature: 0.7,
 235 â”‚       maxTokens: 4000,
 236 â”‚       topP: 0.9,
 237 â”‚       topK: 40
 238 â”‚     });
 239 â”‚ 
 240 â”‚     if (response.success) {
 241 â”‚       console.log('âœ… Resposta recebida do Gemini');
 242 â”‚       console.log('ğŸ“Š Estimativa de tokens:', response.estimatedTokens);
 243 â”‚       console.log('ğŸ’° Custo estimado:', response.estimatedPowerCost);
 244 â”‚       console.log('â±ï¸ Tempo de execuÃ§Ã£o:', response.executionTime + 'ms');
 245 â”‚ 
 246 â”‚       // Limpar a resposta para garantir que seja JSON vÃ¡lido
 247 â”‚       let cleanedResponse = response.result.trim();
 248 â”‚ 
 249 â”‚       console.log('ğŸ”§ Resposta bruta da IA (primeiros 1000 chars):', cleanedResponse.substring(0, 1000));
 250 â”‚ 
 251 â”‚       // MÃºltiplas tentativas de limpeza
 252 â”‚       // 1. Remover markdown
 253 â”‚       cleanedResponse = cleanedResponse.replace(/```json\s*/g, '').replace(/```\s*$/g, '');
 254 â”‚       cleanedResponse = cleanedResponse.replace(/```\s*/g, '');
 255 â”‚ 
 256 â”‚       // 2. Remover possÃ­veis textos antes e depois do JSON
 257 â”‚       const jsonStart = cleanedResponse.indexOf('{');
 258 â”‚       const jsonEnd = cleanedResponse.lastIndexOf('}');
 259 â”‚ 
 260 â”‚       if (jsonStart !== -1 && jsonEnd !== -1 && jsonEnd > jsonStart) {
 261 â”‚         cleanedResponse = cleanedResponse.substring(jsonStart, jsonEnd + 1);
 262 â”‚       }
 263 â”‚ 
 264 â”‚       // 3. Verificar se comeÃ§a e termina com { }
 265 â”‚       if (!cleanedResponse.trim().startsWith('{')) {
 266 â”‚         const firstBrace = cleanedResponse.indexOf('{');
 267 â”‚         if (firstBrace !== -1) {
 268 â”‚           cleanedResponse = cleanedResponse.substring(firstBrace);
 269 â”‚         }
 270 â”‚       }
 271 â”‚ 
 272 â”‚       if (!cleanedResponse.trim().endsWith('}')) {
 273 â”‚         const lastBrace = cleanedResponse.lastIndexOf('}');
 274 â”‚         if (lastBrace !== -1) {
 275 â”‚           cleanedResponse = cleanedResponse.substring(0, lastBrace + 1);
 276 â”‚         }
 277 â”‚       }
 278 â”‚ 
 279 â”‚       console.log('ğŸ”§ Resposta limpa para parsing (primeiros 500 chars):', cleanedResponse.substring(0, 500));
 280 â”‚ 
 281 â”‚       try {
 282 â”‚         const parsedResult = JSON.parse(cleanedResponse);
 283 â”‚         console.log('âœ… Resultado parseado com sucesso');
 284 â”‚         console.log('ğŸ“Š Estrutura do resultado:', {
 285 â”‚           hasTitle: !!parsedResult.titulo,
 286 â”‚           hasDisciplina: !!parsedResult.disciplina,
 287 â”‚           hasTema: !!parsedResult.tema,
 288 â”‚           hasQuestoes: !!parsedResult.questoes,
 289 â”‚           questoesLength: parsedResult.questoes ? parsedResult.questoes.length : 0,
 290 â”‚           keys: Object.keys(parsedResult)
 291 â”‚         });
 292 â”‚ 
 293 â”‚         // ValidaÃ§Ã£o rigorosa para lista de exercÃ­cios
 294 â”‚         if (activityType === 'lista-exercicios') {
 295 â”‚           // Verificar se tem questÃµes
 296 â”‚           if (!parsedResult.questoes || !Array.isArray(parsedResult.questoes)) {
 297 â”‚             console.error('âŒ Estrutura de questÃµes invÃ¡lida');
 298 â”‚             throw new Error('Campo questoes nÃ£o encontrado ou nÃ£o Ã© um array');
 299 â”‚           }
 300 â”‚ 
 301 â”‚           if (parsedResult.questoes.length === 0) {
 302 â”‚             console.error('âŒ Nenhuma questÃ£o gerada pela IA');
 303 â”‚             throw new Error('Array de questÃµes estÃ¡ vazio');
 304 â”‚           }
 305 â”‚ 
 306 â”‚           // Validar cada questÃ£o
 307 â”‚           const questoesValidas = parsedResult.questoes.every((questao: any, index: number) => {
 308 â”‚             const isValid = questao.id && questao.type && questao.enunciado;
 309 â”‚             if (!isValid) {
 310 â”‚               console.error(`âŒ QuestÃ£o ${index + 1} invÃ¡lida:`, questao);
 311 â”‚             }
 312 â”‚             return isValid;
 313 â”‚           });
 314 â”‚ 
 315 â”‚           if (!questoesValidas) {
 316 â”‚             throw new Error('Algumas questÃµes geradas pela IA sÃ£o invÃ¡lidas');
 317 â”‚           }
 318 â”‚ 
 319 â”‚           console.log(`ğŸ“ ${parsedResult.questoes.length} questÃµes vÃ¡lidas geradas pela IA`);
 320 â”‚           console.log('ğŸ“„ Primeira questÃ£o como exemplo:', parsedResult.questoes[0]);
 321 â”‚ 
 322 â”‚           // Marcar como gerado pela IA
 323 â”‚           parsedResult.isGeneratedByAI = true;
 324 â”‚           parsedResult.generatedAt = new Date().toISOString();
 325 â”‚ 
 326 â”‚           // Garantir que todos os campos necessÃ¡rios existem
 327 â”‚           parsedResult.titulo = parsedResult.titulo || contextData.titulo || contextData.title || 'Lista de ExercÃ­cios';
 328 â”‚           parsedResult.disciplina = parsedResult.disciplina || contextData.disciplina || contextData.subject || 'Disciplina';
 329 â”‚           parsedResult.tema = parsedResult.tema || contextData.tema || contextData.theme || 'Tema';
 330 â”‚           parsedResult.numeroQuestoes = parsedResult.questoes.length;
 331 â”‚         }
 332 â”‚ 
 333 â”‚         return parsedResult;
 334 â”‚       } catch (parseError) {
 335 â”‚         console.error('âŒ Erro ao fazer parse do JSON:', parseError);
 336 â”‚         console.error('ğŸ“„ ConteÃºdo que causou erro (primeiros 1000 chars):', cleanedResponse.substring(0, 1000));
 337 â”‚ 
 338 â”‚         // Tentar extrair JSON de forma mais agressiva
 339 â”‚         try {
 340 â”‚           // Buscar por padrÃµes JSON vÃ¡lidos
 341 â”‚           const jsonPattern = /\{[\s\S]*\}/;
 342 â”‚           const match = cleanedResponse.match(jsonPattern);
 343 â”‚ 
 344 â”‚           if (match) {
 345 â”‚             const extractedJson = match[0];
 346 â”‚             console.log('ğŸ”„ Tentando JSON extraÃ­do:', extractedJson.substring(0, 200));
 347 â”‚             const secondAttempt = JSON.parse(extractedJson);
 348 â”‚             console.log('âœ… Segunda tentativa de parse bem sucedida');
 349 â”‚ 
 350 â”‚             // Aplicar mesmas validaÃ§Ãµes
 351 â”‚             if (activityType === 'lista-exercicios') {
 352 â”‚               if (secondAttempt.questoes && Array.isArray(secondAttempt.questoes) && secondAttempt.questoes.length > 0) {
 353 â”‚                 secondAttempt.isGeneratedByAI = true;
 354 â”‚                 secondAttempt.generatedAt = new Date().toISOString();
 355 â”‚                 return secondAttempt;
 356 â”‚               }
 357 â”‚             }
 358 â”‚ 
 359 â”‚             return secondAttempt;
 360 â”‚           }
 361 â”‚         } catch (secondError) {
 362 â”‚           console.error('âŒ Segunda tentativa de parse tambÃ©m falhou:', secondError);
 363 â”‚         }
 364 â”‚ 
 365 â”‚         throw new Error(`Erro ao processar resposta da IA: ${parseError.message}`);
 366 â”‚       }
 367 â”‚ 
 368 â”‚     } else {
 369 â”‚       console.error('âŒ Erro na API Gemini:', response.error);
 370 â”‚       throw new Error(response.error || 'Falha na geraÃ§Ã£o de conteÃºdo');
 371 â”‚     }
 372 â”‚ 
 373 â”‚   } catch (error) {
 374 â”‚     console.error('âŒ Erro crÃ­tico ao gerar conteÃºdo da atividade:', error);
 375 â”‚     throw error;
 376 â”‚   }
 377 â”‚ };
 378 â”‚ 
 379 â”‚ export async function generateActivity(formData: any): Promise<{ success: boolean; content?: string; error?: string }> {
 380 â”‚   console.log('ğŸ¯ generateActivity: Iniciando geraÃ§Ã£o com formData:', formData);
 381 â”‚ 
 382 â”‚   try {
 383 â”‚     // Validar dados obrigatÃ³rios
 384 â”‚     if (!formData.title || !formData.description) {
 385 â”‚       throw new Error('TÃ­tulo e descriÃ§Ã£o sÃ£o obrigatÃ³rios');
 386 â”‚     }
 387 â”‚ 
 388 â”‚     // Preparar dados para a API
 389 â”‚     const activityData = {
 390 â”‚       title: formData.title,
 391 â”‚       description: formData.description,
 392 â”‚       type: formData.typeId || 'default',
 393 â”‚       disciplina: formData.disciplina || 'MatemÃ¡tica',
 394 â”‚       nivel: formData.nivel || 'Ensino MÃ©dio',
 395 â”‚       duracao: formData.duracao || '50 minutos',
 396 â”‚       objetivo: formData.objetivo || formData.description,
 397 â”‚       conteudo: formData.conteudo || formData.description,
 398 â”‚       metodologia: formData.metodologia || 'PrÃ¡tica',
 399 â”‚       recursos: formData.recursos || 'Quadro, computador',
 400 â”‚       avaliacao: formData.avaliacao || 'ParticipaÃ§Ã£o e exercÃ­cios'
 401 â”‚     };
 402 â”‚ 
 403 â”‚     console.log('ğŸ“ Dados preparados para API:', activityData);
 404 â”‚ 
 405 â”‚     // Simular geraÃ§Ã£o da atividade (substituir pela API real quando disponÃ­vel)
 406 â”‚     const generatedContent = await generateActivityContent(activityData);
 407 â”‚ 
 408 â”‚     if (generatedContent) {
 409 â”‚       console.log('âœ… Atividade gerada com sucesso');
 410 â”‚       return {
 411 â”‚         success: true,
 412 â”‚         content: generatedContent
 413 â”‚       };
 414 â”‚     } else {
 415 â”‚       throw new Error('Falha na geraÃ§Ã£o do conteÃºdo');
 416 â”‚     }
 417 â”‚ 
 418 â”‚   } catch (error) {
 419 â”‚     console.error('âŒ Erro na geraÃ§Ã£o da atividade:', error);
 420 â”‚     return {
 421 â”‚       success: false,
 422 â”‚       error: error instanceof Error ? error.message : 'Erro desconhecido'
 423 â”‚     };
 424 â”‚   }
 425 â”‚ }
 426 â”‚ 
 427 â”‚ async function generateActivityContent(activityData: any): Promise<string> {
     Â·                â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Â·                           â•°â”€â”€ `generateActivityContent` redefined here
 428 â”‚   console.log('ğŸ”¨ Gerando conteÃºdo da atividade:', activityData.title);
 429 â”‚ 
 430 â”‚   // Simular delay da API
     â•°â”€â”€â”€â”€
/home/runner/workspace/src/features/schoolpower/construction/api/generateActivity.ts:195:1