ğŸ¯ Contexto
VocÃª estÃ¡ dando vida real e funcional ao School Power da Ponto. School, garantindo personalizaÃ§Ã£o real via API Gemini, utilizando dados do usuÃ¡rio e as 137 atividades possÃ­veis.

Atualmente:
âŒ O sistema exibe atividades genÃ©ricas nÃ£o personalizadas apÃ³s o envio do ContextualizationCard.
âŒ O sistema nÃ£o estÃ¡ usando a API Gemini corretamente para analisar a mensagem inicial e as respostas do quiz.
âŒ O sistema nÃ£o consulta corretamente o arquivo schoolPowerActivities.json para limitar sugestÃµes apenas Ã s 137 atividades disponÃ­veis.

ğŸ”¹ Objetivo
Fazer o fluxo funcionar perfeitamente:

1ï¸âƒ£ UsuÃ¡rio envia a mensagem no ChatInput (ex: â€œPreciso de materiais de revisÃ£o para 3Âº ano, focando em redaÃ§Ã£o e interpretaÃ§Ã£o, para prova dia 28/07.â€)
2ï¸âƒ£ UsuÃ¡rio preenche o ContextualizationCard (matÃ©rias, pÃºblico-alvo, restriÃ§Ãµes, datas, observaÃ§Ãµes).
3ï¸âƒ£ ApÃ³s envio do quiz, o sistema faz uma chamada em tempo real para a API Gemini, enviando:

A mensagem inicial completa.

Todas as respostas do quiz.

As 137 atividades disponÃ­veis do schoolPowerActivities.json.

4ï¸âƒ£ A API Gemini analisa as informaÃ§Ãµes e retorna entre 3 a 5 atividades reais, personalizadas, alinhadas ao contexto do usuÃ¡rio, incluindo:

id (obrigatÃ³rio e deve existir no arquivo de atividades).

title (personalizado, ex: â€œProva de RedaÃ§Ã£o - 28/07 - 3Âº Anoâ€).

description (personalizada, ex: â€œAvaliaÃ§Ã£o com foco em dissertaÃ§Ã£o argumentativa para o 3Âº ano.â€).

5ï¸âƒ£ O sistema valida a resposta da IA:
âœ… Se todos os id existem no schoolPowerActivities.json, renderiza no ActionPlanCard.
âœ… Se vier algo fora do escopo, solicita nova geraÃ§Ã£o ou remove inconsistÃªncias automaticamente.

6ï¸âƒ£ RenderizaÃ§Ã£o no ActionPlanCard:

Exibe os mini-cards checkbox com tÃ­tulo, descriÃ§Ã£o e seleÃ§Ã£o.

Mostra contador de atividades selecionadas.

Permite aprovaÃ§Ã£o apenas apÃ³s selecionar ao menos 1 atividade.

ğŸ”¹ O que precisa ser criado e ajustado
âœ… 1. Garantir coleta e armazenamento correto dos dados:

Garantir que a mensagem do ChatInput seja salva em schoolPowerStore imediatamente ao enviar.

Garantir que todas as respostas do ContextualizationCard sejam armazenadas no mesmo store.

âœ… 2. Criar um arquivo ou utilitÃ¡rio generatePersonalizedPlan.ts:

Faz a chamada Ã  API Gemini usando fetch ou client Gemini SDK com a Key AIzaSyD-Sso0SdyYKoA4M3tQhcWjQ1AoddB7Wo4.

Envia o payload estruturado:

json
Copiar
Editar
{
  "userMessage": "{mensagem_inicial}",
  "quizResponses": {
    "materiasETemas": "{materias}",
    "publicoAlvo": "{publico_alvo}",
    "restricoes": "{restricoes}",
    "datasImportantes": "{datas}",
    "observacoes": "{observacoes}"
  },
  "availableActivities": [{lista das 137 atividades em JSON}]
}
Recebe o JSON da IA Gemini com as sugestÃµes personalizadas.

âœ… 3. Criar um validador validateGeminiPlan.ts:

Verifica se todos os id retornados existem em schoolPowerActivities.json.

Remove ou alerta se houver inconsistÃªncias.

âœ… 4. Renderizar o retorno no ActionPlanCard:

Renderizar os mini-cards checkbox dinÃ¢micos conforme os dados da IA.

Utilizar animaÃ§Ã£o suave (Framer Motion) durante a transiÃ§Ã£o do ContextualizationCard para o ActionPlanCard.

Habilitar botÃ£o de aprovaÃ§Ã£o apenas quando ao menos 1 item for selecionado.

âœ… 5. Utilizar Skeleton Loader ou Spinner durante a requisiÃ§Ã£o.

ğŸ”¹ Exemplo de prompt enviado para a API Gemini:
javascript
Copiar
Editar
VocÃª Ã© a IA do School Power. Seu trabalho Ã© gerar de 3 a 5 atividades personalizadas para um professor ou coordenador educacional, utilizando SOMENTE as atividades disponÃ­veis abaixo.

Mensagem inicial:
"{mensagem_inicial}"

Respostas do Quiz:
- MatÃ©rias e temas: "{materias}"
- PÃºblico-alvo: "{publico_alvo}"
- RestriÃ§Ãµes ou preferÃªncias: "{restricoes}"
- Datas importantes: "{datas}"
- ObservaÃ§Ãµes: "{observacoes}"

Atividades disponÃ­veis:
{JSON.stringify(atividadesDisponiveis)}

Retorne um JSON com atividades, cada uma com:
- id (da atividade existente)
- title (personalizado, curto e claro)
- description (personalizada)

Exemplo:
[
  {
    "id": "prova-interativa",
    "title": "Prova de RedaÃ§Ã£o - 28/07 - 3Âº Ano",
    "description": "AvaliaÃ§Ã£o interativa com foco em dissertaÃ§Ã£o argumentativa para o 3Âº ano."
  },
  ...
]
ğŸ”¹ ConsideraÃ§Ãµes TÃ©cnicas Importantes
âœ… Utilize TypeScript estrito.
âœ… Use zustand para o gerenciamento de estado centralizado.
âœ… Padronize estilos e utilize Framer Motion para UX suave.
âœ… Crie logs claros em caso de erro na resposta da IA.
âœ… Permita reenvio caso a IA retorne dados inconsistentes.
âœ… Prepare para escalabilidade (fÃ¡cil adiÃ§Ã£o de novas atividades).
âœ… CÃ³digo limpo, modular, fÃ¡cil de auditar.

âœ… Resultado Esperado
âœ… UsuÃ¡rio envia mensagem > Responde quiz > API Gemini gera plano personalizado real > SugestÃµes aparecem corretamente no ActionPlanCard > UsuÃ¡rio aprova > Atividades sÃ£o geradas corretamente de forma personalizada.