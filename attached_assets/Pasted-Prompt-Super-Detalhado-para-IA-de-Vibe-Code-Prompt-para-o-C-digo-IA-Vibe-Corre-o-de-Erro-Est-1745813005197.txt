Prompt Super Detalhado para IA de Vibe Code
üõ†Ô∏è Prompt para o C√≥digo IA Vibe - Corre√ß√£o de Erro: Estrutura do Banco de Dados Precisa ser Atualizada

T√≠tulo:

 Corre√ß√£o de Erro ao Carregar Anota√ß√µes no Modal da Apostila Inteligente: "A estrutura do banco de dados precisa ser atualizada"

Contexto e Problema:

 Em nossa plataforma, temos uma integra√ß√£o entre o Modal de Anota√ß√µes (Caderno) e o Modal da Apostila Inteligente. O fluxo permite que o usu√°rio crie anota√ß√µes no Caderno, como exportar para a Apostila Inteligente (salvando-as em uma pasta espec√≠fica), e como visualizar/editar no Modal da Apostila. No entanto, ao acessar o Modal da Apostila Inteligente para visualizar as anota√ß√µes exportadas, est√° aparecendo o seguinte erro:

"Erro ao carregar anota√ß√µes: A estrutura do banco de dados precisa ser atualizada. Use a op√ß√£o 'Corrigir Rela√ß√£o Apostila' no menu Workflow."

Esse erro indica que a estrutura do banco de dados no Supabase n√£o est√° homologada com o que a aplica√ß√£o espera. Provavelmente, as tabelas apostila_anotacoes e apostila_pastas n√£o foram criadas corretamente, ou uma migra√ß√£o pendente n√£o foi aplicada. A mensagem sugere usar a op√ß√£o "Corrigir Rela√ß√£o Apostila" no menu Workflow, mas precisamos garantir que essa funcionalidade exista e funcione corretamente. O objetivo deste prompt √© corrigir esse erro, criando ou ajustando as tabelas permitidas, implementando a funcionalidade "Corrigir Rela√ß√£o Apostila", e ajustando a consulta para carregar as anota√ß√µes.

üß© Detalhamento do Ambiente T√©cnico

Estrutura do Banco de Dados (Supabase):

 As anota√ß√µes s√£o gerenciadas em tabelas separadas para o Caderno e a Apostila Inteligente, conforme descrito abaixo:

Tabela caderno_anotacoes :
identifica√ß√£o (UUID)
user_id (UUID do usu√°rio autenticado)
t√≠tulo (string)
conteudo (texto)
modelo_anotacao (string: ex.: "Estudo Completo", "Mapa Mental")
tags (matriz de strings)
data_criacao (carimbo de data/hora)
data_atualiza√ß√£o (carimbo de data/hora)
status (string: ex.: "rascunho", "exportado")
Tabela apostila_anotacoes :
identifica√ß√£o (UUID)
user_id (UUID do usu√°rio autenticado)
pasta_id (UUID, null se n√£o estiver associado a uma pasta)
t√≠tulo (string)
conteudo (texto)
modelo_anotacao (string)
tags (matriz de strings)
data_criacao (carimbo de data/hora)
data_exportacao (carimbo de data/hora)
origem (string: "caderno" ou "criado_na_apostila")
Tabela apostila_pastas :
identifica√ß√£o (UUID)
user_id (UUID do usu√°rio autenticado)
nome (string)
descri√ß√£o (string, opcional)
data_criacao (carimbo de data/hora)
Tabela user_activity_logs (para registros de a√ß√µes):
identifica√ß√£o (UUID)
ID do usu√°rio (UUID)
acao (string: ex.: "exportou anota√ß√£o")
anotacao_id (UUID)
carimbo de data/hora (timestamp)
detalhes (string, opcional)
Configura√ß√µes do Supabase:

O Supabase est√° configurado com Row-Level Security (RLS) ativado.
O Supabase Realtime est√° sendo usado para atualizar o Modal da Apostila Inteligente automaticamente.
A aplica√ß√£o espera que as tabelas apostila_anotacoes e apostila_pastas existam com uma rela√ß√£o de chave estrangeira entre apostila_anotacoes.pasta_id e apostila_pastas.id .
Fluxo Atual (Com Problema):

O usu√°rio cria uma anota√ß√£o no Modal do Caderno e a salva (inserida na tabela caderno_anotacoes ).
O usu√°rio clicou em "Salvar na Apostila Inteligente":
Um modal aparece para selecionar uma pasta, editar o t√≠tulo e adicionar tags.
A anota√ß√£o √© copiada para a tabela apostila_anotacoes .
O usu√°rio que acessa o Modal da Apostila Inteligente:
A consulta tenta carregar as anota√ß√µes da tabela apostila_anotacoes , incluindo informa√ß√µes da tabela apostila_pastas , mas retorna o erro: "A estrutura do banco de dados precisa ser atualizada."